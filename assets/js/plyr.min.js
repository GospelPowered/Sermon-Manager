(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define("Plyr",factory):global.Plyr=factory()})(this,function(){"use strict";var providers={html5:"html5",youtube:"youtube",vimeo:"vimeo"};var types={audio:"audio",video:"video"};var defaults={enabled:true,title:"",debug:false,autoplay:false,autopause:true,seekTime:10,volume:1,muted:false,duration:null,displayDuration:true,invertTime:true,toggleInvert:true,ratio:"16:9",clickToPlay:true,hideControls:true,showPosterOnEnd:false,disableContextMenu:true,loadSprite:true,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.0.2/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:"default",options:["hd2160","hd1440","hd1080","hd720","large","medium","small","tiny","default"]},loop:{active:false},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2]},keyboard:{focused:true,global:false},tooltips:{controls:false,seek:true},captions:{active:false,language:window.navigator.language.split("-")[0]},fullscreen:{enabled:true,fallback:true,iosNative:false},storage:{enabled:true,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime} secs",play:"Play",pause:"Pause",forward:"Forward {seektime} secs",seek:"Seek",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",speed:"Speed",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",none:"None",disabled:"Disabled",advertisement:"Ad"},urls:{vimeo:{api:"https://player.vimeo.com/api/player.js"},youtube:{api:"https://www.youtube.com/iframe_api"},googleIMA:{api:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,forward:null,mute:null,volume:null,captions:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","qualityrequested","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress--buffer",played:".plyr__progress--played",loop:".plyr__progress--loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",menu:{quality:".js-plyr__menu__list--quality"}},classNames:{video:"plyr__video-wrapper",embed:"plyr__video-embed",ads:"plyr__ads",control:"plyr__control",type:"plyr--{0}",provider:"plyr--{0}",stopped:"plyr--stopped",playing:"plyr--playing",loading:"plyr--loading",error:"plyr--has-error",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isIos:"plyr--is-ios",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},tabFocus:"plyr__tab-focus"},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id"}},keys:{google:null},ads:{enabled:false,publisherId:""}};var commonjsGlobal=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}var loadjs_umd=createCommonjsModule(function(module,exports){(function(root,factory){if(typeof undefined==="function"&&undefined.amd){undefined([],factory)}else{module.exports=factory()}})(commonjsGlobal,function(){var devnull=function(){},bundleIdCache={},bundleResultCache={},bundleCallbackQueue={};function subscribe(bundleIds,callbackFn){bundleIds=bundleIds.push?bundleIds:[bundleIds];var depsNotFound=[],i=bundleIds.length,numWaiting=i,fn,bundleId,r,q;fn=function(bundleId,pathsNotFound){if(pathsNotFound.length)depsNotFound.push(bundleId);numWaiting--;if(!numWaiting)callbackFn(depsNotFound)};while(i--){bundleId=bundleIds[i];r=bundleResultCache[bundleId];if(r){fn(bundleId,r);continue}q=bundleCallbackQueue[bundleId]=bundleCallbackQueue[bundleId]||[];q.push(fn)}}function publish(bundleId,pathsNotFound){if(!bundleId)return;var q=bundleCallbackQueue[bundleId];bundleResultCache[bundleId]=pathsNotFound;if(!q)return;while(q.length){q[0](bundleId,pathsNotFound);q.splice(0,1)}}function executeCallbacks(args,depsNotFound){if(args.call)args={success:args};if(depsNotFound.length)(args.error||devnull)(depsNotFound);else(args.success||devnull)(args)}function loadFile(path,callbackFn,args,numTries){var doc=document,async=args.async,maxTries=(args.numRetries||0)+1,beforeCallbackFn=args.before||devnull,isCss,e;numTries=numTries||0;if(/(^css!|\.css$)/.test(path)){isCss=true;e=doc.createElement("link");e.rel="stylesheet";e.href=path.replace(/^css!/,"")}else{e=doc.createElement("script");e.src=path;e.async=async===undefined?true:async}e.onload=e.onerror=e.onbeforeload=function(ev){var result=ev.type[0];if(isCss&&"hideFocus"in e){try{if(!e.sheet.cssText.length)result="e"}catch(x){result="e"}}if(result=="e"){numTries+=1;if(numTries<maxTries){return loadFile(path,callbackFn,args,numTries)}}callbackFn(path,result,ev.defaultPrevented)};if(beforeCallbackFn(path,e)!==false)doc.head.appendChild(e)}function loadFiles(paths,callbackFn,args){paths=paths.push?paths:[paths];var numWaiting=paths.length,x=numWaiting,pathsNotFound=[],fn,i;fn=function(path,result,defaultPrevented){if(result=="e")pathsNotFound.push(path);if(result=="b"){if(defaultPrevented)pathsNotFound.push(path);else return}numWaiting--;if(!numWaiting)callbackFn(pathsNotFound)};for(i=0;i<x;i++)loadFile(paths[i],fn,args)}function loadjs(paths,arg1,arg2){var bundleId,args;if(arg1&&arg1.trim)bundleId=arg1;args=(bundleId?arg2:arg1)||{};if(bundleId){if(bundleId in bundleIdCache){throw"LoadJS"}else{bundleIdCache[bundleId]=true}}loadFiles(paths,function(pathsNotFound){executeCallbacks(args,pathsNotFound);publish(bundleId,pathsNotFound)},args)}loadjs.ready=function ready(deps,args){subscribe(deps,function(depsNotFound){executeCallbacks(args,depsNotFound)});return loadjs};loadjs.done=function done(bundleId){publish(bundleId,[])};loadjs.reset=function reset(){bundleIdCache={};bundleResultCache={};bundleCallbackQueue={}};loadjs.isDefined=function isDefined(bundleId){return bundleId in bundleIdCache};return loadjs})});var asyncGenerator=function(){function AwaitValue(value){this.value=value}function AsyncGenerator(gen){var front,back;function send(key,arg){return new Promise(function(resolve,reject){var request={key:key,arg:arg,resolve:resolve,reject:reject,next:null};if(back){back=back.next=request}else{front=back=request;resume(key,arg)}})}function resume(key,arg){try{var result=gen[key](arg);var value=result.value;if(value instanceof AwaitValue){Promise.resolve(value.value).then(function(arg){resume("next",arg)},function(arg){resume("throw",arg)})}else{settle(result.done?"return":"normal",result.value)}}catch(err){settle("throw",err)}}function settle(type,value){switch(type){case"return":front.resolve({value:value,done:true});break;case"throw":front.reject(value);break;default:front.resolve({value:value,done:false});break}front=front.next;if(front){resume(front.key,front.arg)}else{back=null}}this._invoke=send;if(typeof gen.return!=="function"){this.return=undefined}}if(typeof Symbol==="function"&&Symbol.asyncIterator){AsyncGenerator.prototype[Symbol.asyncIterator]=function(){return this}}AsyncGenerator.prototype.next=function(arg){return this._invoke("next",arg)};AsyncGenerator.prototype.throw=function(arg){return this._invoke("throw",arg)};AsyncGenerator.prototype.return=function(arg){return this._invoke("return",arg)};return{wrap:function(fn){return function(){return new AsyncGenerator(fn.apply(this,arguments))}},await:function(value){return new AwaitValue(value)}}}();var classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var defineProperty=function(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj};var slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var toConsumableArray=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}else{return Array.from(arr)}};var utils={is:{plyr:function plyr(input){return this.instanceof(input,window.Plyr)},object:function object(input){return this.getConstructor(input)===Object},number:function number(input){return this.getConstructor(input)===Number&&!Number.isNaN(input)},string:function string(input){return this.getConstructor(input)===String},boolean:function boolean(input){return this.getConstructor(input)===Boolean},function:function _function(input){return this.getConstructor(input)===Function},array:function array(input){return!this.nullOrUndefined(input)&&Array.isArray(input)},weakMap:function weakMap(input){return this.instanceof(input,window.WeakMap)},nodeList:function nodeList(input){return this.instanceof(input,window.NodeList)},element:function element(input){return this.instanceof(input,window.Element)},textNode:function textNode(input){return this.getConstructor(input)===Text},event:function event(input){return this.instanceof(input,window.Event)},cue:function cue(input){return this.instanceof(input,window.TextTrackCue)||this.instanceof(input,window.VTTCue)},track:function track(input){return this.instanceof(input,TextTrack)||!this.nullOrUndefined(input)&&this.string(input.kind)},url:function url(input){return!this.nullOrUndefined(input)&&/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-/]))?/.test(input)},nullOrUndefined:function nullOrUndefined(input){return input===null||typeof input==="undefined"},empty:function empty(input){return this.nullOrUndefined(input)||(this.string(input)||this.array(input)||this.nodeList(input))&&!input.length||this.object(input)&&!Object.keys(input).length},instanceof:function _instanceof$$1(input,constructor){return Boolean(input&&constructor&&input instanceof constructor)},getConstructor:function getConstructor(input){return!this.nullOrUndefined(input)?input.constructor:null}},getBrowser:function getBrowser(){return{isIE:false||!!document.documentMode,isWebkit:"WebkitAppearance"in document.documentElement.style&&!/Edge/.test(navigator.userAgent),isIPhone:/(iPhone|iPod)/gi.test(navigator.platform),isIos:/(iPad|iPhone|iPod)/gi.test(navigator.platform)}},fetch:function fetch(url){var responseType=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"text";return new Promise(function(resolve,reject){try{var request=new XMLHttpRequest;if(!("withCredentials"in request)){return}request.addEventListener("load",function(){if(responseType==="text"){try{resolve(JSON.parse(request.responseText))}catch(e){resolve(request.responseText)}}else{resolve(request.response)}});request.addEventListener("error",function(){throw new Error(request.statusText)});request.open("GET",url,true);request.responseType=responseType;request.send()}catch(e){reject(e)}})},loadScript:function loadScript(url){return new Promise(function(resolve,reject){loadjs_umd(url,{success:resolve,error:reject})})},loadSprite:function loadSprite(url,id){if(!utils.is.string(url)){return}var prefix="cache-";var hasId=utils.is.string(id);var isCached=false;var exists=function exists(){return document.querySelectorAll("#"+id).length};function injectSprite(data){if(hasId&&exists()){return}this.innerHTML=data;document.body.insertBefore(this,document.body.childNodes[0])}if(!hasId||!exists()){var container=document.createElement("div");utils.toggleHidden(container,true);if(hasId){container.setAttribute("id",id)}if(support.storage){var cached=window.localStorage.getItem(prefix+id);isCached=cached!==null;if(isCached){var data=JSON.parse(cached);injectSprite.call(container,data.content);return}}utils.fetch(url).then(function(result){if(utils.is.empty(result)){return}if(support.storage){window.localStorage.setItem(prefix+id,JSON.stringify({content:result}))}injectSprite.call(container,result)}).catch(function(){})}},generateId:function generateId(prefix){return prefix+"-"+Math.floor(Math.random()*1e4)},inFrame:function inFrame(){try{return window.self!==window.top}catch(e){return true}},wrap:function wrap(elements,wrapper){var targets=elements.length?elements:[elements];Array.from(targets).reverse().forEach(function(element,index){var child=index>0?wrapper.cloneNode(true):wrapper;var parent=element.parentNode;var sibling=element.nextSibling;child.appendChild(element);if(sibling){parent.insertBefore(child,sibling)}else{parent.appendChild(child)}})},createElement:function createElement(type,attributes,text){var element=document.createElement(type);if(utils.is.object(attributes)){utils.setAttributes(element,attributes)}if(utils.is.string(text)){element.textContent=text}return element},insertAfter:function insertAfter(element,target){target.parentNode.insertBefore(element,target.nextSibling)},insertElement:function insertElement(type,parent,attributes,text){parent.appendChild(utils.createElement(type,attributes,text))},removeElement:function removeElement(element){if(!utils.is.element(element)||!utils.is.element(element.parentNode)){return}if(utils.is.nodeList(element)||utils.is.array(element)){Array.from(element).forEach(utils.removeElement);return}element.parentNode.removeChild(element)},emptyElement:function emptyElement(element){var length=element.childNodes.length;while(length>0){element.removeChild(element.lastChild);length-=1}},replaceElement:function replaceElement(newChild,oldChild){if(!utils.is.element(oldChild)||!utils.is.element(oldChild.parentNode)||!utils.is.element(newChild)){return null}oldChild.parentNode.replaceChild(newChild,oldChild);return newChild},setAttributes:function setAttributes(element,attributes){if(!utils.is.element(element)||utils.is.empty(attributes)){return}Object.keys(attributes).forEach(function(key){element.setAttribute(key,attributes[key])})},getAttributesFromSelector:function getAttributesFromSelector(sel,existingAttributes){if(!utils.is.string(sel)||utils.is.empty(sel)){return{}}var attributes={};var existing=existingAttributes;sel.split(",").forEach(function(s){var selector=s.trim();var className=selector.replace(".","");var stripped=selector.replace(/[[\]]/g,"");var parts=stripped.split("=");var key=parts[0];var value=parts.length>1?parts[1].replace(/["']/g,""):"";var start=selector.charAt(0);switch(start){case".":if(utils.is.object(existing)&&utils.is.string(existing.class)){existing.class+=" "+className}attributes.class=className;break;case"#":attributes.id=selector.replace("#","");break;case"[":attributes[key]=value;break;default:break}});return attributes},toggleClass:function toggleClass(element,className,toggle){if(utils.is.element(element)){var contains=element.classList.contains(className);element.classList[toggle?"add":"remove"](className);return toggle&&!contains||!toggle&&contains}return null},hasClass:function hasClass(element,className){return utils.is.element(element)&&element.classList.contains(className)},toggleHidden:function toggleHidden(element,toggle){if(!utils.is.element(element)){return}if(toggle){element.setAttribute("hidden","")}else{element.removeAttribute("hidden")}},matches:function matches(element,selector){var prototype={Element:Element};function match(){return Array.from(document.querySelectorAll(selector)).includes(this)}var matches=prototype.matches||prototype.webkitMatchesSelector||prototype.mozMatchesSelector||prototype.msMatchesSelector||match;return matches.call(element,selector)},getElements:function getElements(selector){return this.elements.container.querySelectorAll(selector)},getElement:function getElement(selector){return this.elements.container.querySelector(selector)},findElements:function findElements(){try{this.elements.controls=utils.getElement.call(this,this.config.selectors.controls.wrapper);this.elements.buttons={play:utils.getElements.call(this,this.config.selectors.buttons.play),pause:utils.getElement.call(this,this.config.selectors.buttons.pause),restart:utils.getElement.call(this,this.config.selectors.buttons.restart),rewind:utils.getElement.call(this,this.config.selectors.buttons.rewind),fastForward:utils.getElement.call(this,this.config.selectors.buttons.fastForward),mute:utils.getElement.call(this,this.config.selectors.buttons.mute),pip:utils.getElement.call(this,this.config.selectors.buttons.pip),airplay:utils.getElement.call(this,this.config.selectors.buttons.airplay),settings:utils.getElement.call(this,this.config.selectors.buttons.settings),captions:utils.getElement.call(this,this.config.selectors.buttons.captions),fullscreen:utils.getElement.call(this,this.config.selectors.buttons.fullscreen)};this.elements.progress=utils.getElement.call(this,this.config.selectors.progress);this.elements.inputs={seek:utils.getElement.call(this,this.config.selectors.inputs.seek),volume:utils.getElement.call(this,this.config.selectors.inputs.volume)};this.elements.display={buffer:utils.getElement.call(this,this.config.selectors.display.buffer),duration:utils.getElement.call(this,this.config.selectors.display.duration),currentTime:utils.getElement.call(this,this.config.selectors.display.currentTime)};if(utils.is.element(this.elements.progress)){this.elements.display.seekTooltip=this.elements.progress.querySelector("."+this.config.classNames.tooltip)}return true}catch(error){this.debug.warn("It looks like there is a problem with your custom controls HTML",error);this.toggleNativeControls(true);return false}},getFocusElement:function getFocusElement(){var focused=document.activeElement;if(!focused||focused===document.body){focused=null}else{focused=document.querySelector(":focus")}return focused},trapFocus:function trapFocus(){var element=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var toggle=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!utils.is.element(element)){return}var focusable=utils.getElements.call(this,"button:not(:disabled), input:not(:disabled), [tabindex]");var first=focusable[0];var last=focusable[focusable.length-1];var trap=function trap(event){if(event.key!=="Tab"||event.keyCode!==9){return}var focused=utils.getFocusElement();if(focused===last&&!event.shiftKey){first.focus();event.preventDefault()}else if(focused===first&&event.shiftKey){last.focus();event.preventDefault()}};if(toggle){utils.on(this.elements.container,"keydown",trap,false)}else{utils.off(this.elements.container,"keydown",trap,false)}},toggleListener:function toggleListener(elements,event,callback,toggle,passive,capture){if(utils.is.empty(elements)||utils.is.empty(event)||!utils.is.function(callback)){return}if(utils.is.nodeList(elements)||utils.is.array(elements)){Array.from(elements).forEach(function(element){if(element instanceof Node){utils.toggleListener.call(null,element,event,callback,toggle,passive,capture)}});return}var events=event.split(" ");var options=utils.is.boolean(capture)?capture:false;if(support.passiveListeners){options={passive:utils.is.boolean(passive)?passive:true,capture:utils.is.boolean(capture)?capture:false}}events.forEach(function(type){elements[toggle?"addEventListener":"removeEventListener"](type,callback,options)})},on:function on(element,events,callback,passive,capture){utils.toggleListener(element,events,callback,true,passive,capture)},off:function off(element,events,callback,passive,capture){utils.toggleListener(element,events,callback,false,passive,capture)},dispatchEvent:function dispatchEvent(element,type,bubbles,detail){if(!utils.is.element(element)||!utils.is.string(type)){return}var event=new CustomEvent(type,{bubbles:utils.is.boolean(bubbles)?bubbles:false,detail:Object.assign({},detail,{plyr:utils.is.plyr(this)?this:null})});element.dispatchEvent(event)},toggleState:function toggleState(element,input){if(utils.is.array(element)||utils.is.nodeList(element)){Array.from(element).forEach(function(target){return utils.toggleState(target,input)});return}if(!utils.is.element(element)){return}var pressed=element.getAttribute("aria-pressed")==="true";var state=utils.is.boolean(input)?input:!pressed;element.setAttribute("aria-pressed",state)},getPercentage:function getPercentage(current,max){if(current===0||max===0||Number.isNaN(current)||Number.isNaN(max)){return 0}return(current/max*100).toFixed(2)},getHours:function getHours(value){return parseInt(value/60/60%60,10)},getMinutes:function getMinutes(value){return parseInt(value/60%60,10)},getSeconds:function getSeconds(value){return parseInt(value%60,10)},formatTime:function formatTime(){var time=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var displayHours=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var inverted=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!utils.is.number(time)){return this.formatTime(null,displayHours,inverted)}var format=function format(value){return("0"+value).slice(-2)};var hours=this.getHours(time);var mins=this.getMinutes(time);var secs=this.getSeconds(time);if(displayHours||hours>0){hours=hours+":"}else{hours=""}return""+(inverted?"-":"")+hours+format(mins)+":"+format(secs)},extend:function extend(){var target=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};for(var _len=arguments.length,sources=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){sources[_key-1]=arguments[_key]}if(!sources.length){return target}var source=sources.shift();if(!utils.is.object(source)){return target}Object.keys(source).forEach(function(key){if(utils.is.object(source[key])){if(!Object.keys(target).includes(key)){Object.assign(target,defineProperty({},key,{}))}utils.extend(target[key],source[key])}else{Object.assign(target,defineProperty({},key,source[key]))}});return utils.extend.apply(utils,[target].concat(toConsumableArray(sources)))},getProviderByUrl:function getProviderByUrl(url){if(/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.?be)\/.+$/.test(url)){return providers.youtube}if(/^https?:\/\/player.vimeo.com\/video\/\d{8,}(?=\b|\/)/.test(url)){return providers.vimeo}return null},parseYouTubeId:function parseYouTubeId(url){if(utils.is.empty(url)){return null}var regex=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;return url.match(regex)?RegExp.$2:url},parseVimeoId:function parseVimeoId(url){if(utils.is.empty(url)){return null}if(utils.is.number(Number(url))){return url}var regex=/^.*(vimeo.com\/|video\/)(\d+).*/;return url.match(regex)?RegExp.$2:url},parseUrl:function parseUrl(url){var parser=document.createElement("a");parser.href=url;return parser},getUrlParams:function getUrlParams(input){var search=input;if(input.startsWith("http://")||input.startsWith("https://")){var _parseUrl=this.parseUrl(input);search=_parseUrl.search}if(this.is.empty(search)){return null}var hashes=search.slice(search.indexOf("?")+1).split("&");return hashes.reduce(function(params,hash){var _hash$split=hash.split("="),_hash$split2=slicedToArray(_hash$split,2),key=_hash$split2[0],val=_hash$split2[1];return Object.assign(params,defineProperty({},key,decodeURIComponent(val)))},{})},buildUrlParams:function buildUrlParams(input){if(!utils.is.object(input)){return""}return Object.keys(input).map(function(key){return encodeURIComponent(key)+"="+encodeURIComponent(input[key])}).join("&")},stripHTML:function stripHTML(source){var fragment=document.createDocumentFragment();var element=document.createElement("div");fragment.appendChild(element);element.innerHTML=source;return fragment.firstChild.innerText},getAspectRatio:function getAspectRatio(width,height){var getRatio=function getRatio(w,h){return h===0?w:getRatio(h,w%h)};var ratio=getRatio(width,height);return width/ratio+":"+height/ratio},get transitionEndEvent(){var element=document.createElement("span");var events={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};var type=Object.keys(events).find(function(event){return element.style[event]!==undefined});return utils.is.string(type)?events[type]:false},repaint:function repaint(element){setTimeout(function(){utils.toggleHidden(element,true);element.offsetHeight;utils.toggleHidden(element,false)},0)}};var support={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check:function check(type,provider,inline){var api=false;var ui=false;var browser=utils.getBrowser();var playsInline=browser.isIPhone&&inline&&support.inline;switch(provider+":"+type){case"html5:video":api=support.video;ui=api&&support.rangeInput&&(!browser.isIPhone||playsInline);break;case"html5:audio":api=support.audio;ui=api&&support.rangeInput;break;case"youtube:video":case"vimeo:video":api=true;ui=support.rangeInput&&(!browser.isIPhone||playsInline);break;default:api=support.audio&&support.video;ui=api&&support.rangeInput}return{api:api,ui:ui}},pip:function(){var browser=utils.getBrowser();return!browser.isIPhone&&utils.is.function(utils.createElement("video").webkitSetPresentationMode)}(),airplay:utils.is.function(window.WebKitPlaybackTargetAvailabilityEvent),inline:"playsInline"in document.createElement("video"),mime:function mime(type){var media=this.media;try{if(!this.isHTML5||!utils.is.function(media.canPlayType)){return false}if(this.isVideo){switch(type){case"video/webm":return media.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/no/,"");case"video/mp4":return media.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,"");case"video/ogg":return media.canPlayType('video/ogg; codecs="theora"').replace(/no/,"");default:return false}}else if(this.isAudio){switch(type){case"audio/mpeg":return media.canPlayType("audio/mpeg;").replace(/no/,"");case"audio/ogg":return media.canPlayType('audio/ogg; codecs="vorbis"').replace(/no/,"");case"audio/wav":return media.canPlayType('audio/wav; codecs="1"').replace(/no/,"");default:return false}}}catch(e){return false}return false},textTracks:"textTracks"in document.createElement("video"),passiveListeners:function(){var supported=false;try{var options=Object.defineProperty({},"passive",{get:function get(){supported=true;return null}});window.addEventListener("test",null,options)}catch(e){}return supported}(),rangeInput:function(){var range=document.createElement("input");range.type="range";return range.type==="range"}(),touch:"ontouchstart"in document.documentElement,transitions:utils.transitionEndEvent!==false,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches};var noop=function noop(){};var Console=function(){function Console(){var enabled=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;classCallCheck(this,Console);this.enabled=window.console&&enabled;if(this.enabled){this.log("Debugging enabled")}}createClass(Console,[{key:"log",get:function get$$1(){return this.enabled?Function.prototype.bind.call(console.log,console):noop}},{key:"warn",get:function get$$1(){return this.enabled?Function.prototype.bind.call(console.warn,console):noop}},{key:"error",get:function get$$1(){return this.enabled?Function.prototype.bind.call(console.error,console):noop}}]);return Console}();var browser=utils.getBrowser();function onChange(){if(!this.enabled){return}var button=this.player.elements.buttons.fullscreen;if(utils.is.element(button)){utils.toggleState(button,this.active)}utils.dispatchEvent(this.target,this.active?"enterfullscreen":"exitfullscreen",true);if(!browser.isIos){utils.trapFocus.call(this.player,this.target,this.active)}}function toggleFallback(){var toggle=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(toggle){this.scrollPosition={x:window.scrollX||0,y:window.scrollY||0}}else{window.scrollTo(this.scrollPosition.x,this.scrollPosition.y)}document.body.style.overflow=toggle?"hidden":"";utils.toggleClass(this.target,this.player.config.classNames.fullscreen.fallback,toggle);onChange.call(this)}var Fullscreen=function(){function Fullscreen(player){var _this=this;classCallCheck(this,Fullscreen);this.player=player;this.prefix=Fullscreen.prefix;this.name=Fullscreen.name;this.scrollPosition={x:0,y:0};utils.on(document,this.prefix==="ms"?"MSFullscreenChange":this.prefix+"fullscreenchange",function(){onChange.call(_this)});utils.on(this.player.elements.container,"dblclick",function(){_this.toggle()});utils.on(this.player.elements.controls,"dblclick",function(event){return event.stopPropagation()});this.update()}createClass(Fullscreen,[{key:"update",value:function update(){if(this.enabled){this.player.debug.log((Fullscreen.native?"Native":"Fallback")+" fullscreen enabled")}else{this.player.debug.log("Fullscreen not supported and fallback disabled")}utils.toggleClass(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.enabled)}},{key:"enter",value:function enter(){if(!this.enabled){return}if(browser.isIos&&this.player.config.fullscreen.iosNative){if(this.player.playing){this.target.webkitEnterFullscreen()}}else if(!Fullscreen.native){toggleFallback.call(this,true)}else if(!this.prefix){this.target.requestFullScreen()}else if(!utils.is.empty(this.prefix)){this.target[this.prefix+"Request"+this.name]()}}},{key:"exit",value:function exit(){if(!this.enabled){return}if(browser.isIos&&this.player.config.fullscreen.iosNative){this.target.webkitExitFullscreen();this.player.play()}else if(!Fullscreen.native){toggleFallback.call(this,false)}else if(!this.prefix){document.cancelFullScreen()}else if(!utils.is.empty(this.prefix)){var action=this.prefix==="moz"?"Cancel":"Exit";document[""+this.prefix+action+this.name]()}}},{key:"toggle",value:function toggle(){if(!this.active){this.enter()}else{this.exit()}}},{key:"enabled",get:function get$$1(){var fallback=this.player.config.fullscreen.fallback&&!utils.inFrame();return(Fullscreen.native||fallback)&&this.player.config.fullscreen.enabled&&this.player.supported.ui&&this.player.isVideo}},{key:"active",get:function get$$1(){if(!this.enabled){return false}if(!Fullscreen.native){return utils.hasClass(this.target,this.player.config.classNames.fullscreen.fallback)}var element=!this.prefix?document.fullscreenElement:document[""+this.prefix+this.name+"Element"];return element===this.target}},{key:"target",get:function get$$1(){return browser.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.container}}],[{key:"native",get:function get$$1(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},{key:"prefix",get:function get$$1(){if(utils.is.function(document.exitFullscreen)){return false}var value="";var prefixes=["webkit","moz","ms"];prefixes.some(function(pre){if(utils.is.function(document[pre+"ExitFullscreen"])||utils.is.function(document[pre+"CancelFullScreen"])){value=pre;return true}return false});return value}},{key:"name",get:function get$$1(){return this.prefix==="moz"?"FullScreen":"Fullscreen"}}]);return Fullscreen}();var captions={setup:function setup(){if(!this.supported.ui){return}var stored=this.storage.get("language");if(!utils.is.empty(stored)){this.captions.language=stored}if(utils.is.empty(this.captions.language)){this.captions.language=this.config.captions.language.toLowerCase()}if(!utils.is.boolean(this.captions.active)){var active=this.storage.get("captions");if(utils.is.boolean(active)){this.captions.active=active}else{this.captions.active=this.config.captions.active}}if(!this.isVideo||this.isYouTube||this.isHTML5&&!support.textTracks){if(utils.is.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")){controls.setCaptionsMenu.call(this)}return}if(!utils.is.element(this.elements.captions)){this.elements.captions=utils.createElement("div",utils.getAttributesFromSelector(this.config.selectors.captions));utils.insertAfter(this.elements.captions,this.elements.wrapper)}utils.toggleClass(this.elements.container,this.config.classNames.captions.enabled,!utils.is.empty(captions.getTracks.call(this)));var tracks=captions.getTracks.call(this);if(utils.is.empty(tracks)){return}var browser=utils.getBrowser();if(browser.isIE&&window.URL){var elements=this.media.querySelectorAll("track");Array.from(elements).forEach(function(track){var src=track.getAttribute("src");var href=utils.parseUrl(src);if(href.hostname!==window.location.href.hostname&&["http:","https:"].includes(href.protocol)){utils.fetch(src,"blob").then(function(blob){track.setAttribute("src",window.URL.createObjectURL(blob))}).catch(function(){utils.removeElement(track)})}})}captions.setLanguage.call(this);captions.show.call(this);if(utils.is.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")){controls.setCaptionsMenu.call(this)}},setLanguage:function setLanguage(){var _this=this;if(this.isHTML5&&this.isVideo){captions.getTracks.call(this).forEach(function(track){utils.on(track,"cuechange",function(event){return captions.setCue.call(_this,event)});track.mode="hidden"});var currentTrack=captions.getCurrentTrack.call(this);if(utils.is.track(currentTrack)){if(Array.from(currentTrack.activeCues||[]).length){captions.setCue.call(this,currentTrack)}}}else if(this.isVimeo&&this.captions.active){this.embed.enableTextTrack(this.language)}},getTracks:function getTracks(){if(utils.is.nullOrUndefined(this.media)){return[]}return Array.from(this.media.textTracks||[]).filter(function(track){return["captions","subtitles"].includes(track.kind)})},getCurrentTrack:function getCurrentTrack(){var _this2=this;return captions.getTracks.call(this).find(function(track){return track.language.toLowerCase()===_this2.language})},setCue:function setCue(input){var track=utils.is.event(input)?input.target:input;var activeCues=track.activeCues;var active=activeCues.length&&activeCues[0];var currentTrack=captions.getCurrentTrack.call(this);if(track!==currentTrack){return}if(utils.is.cue(active)){captions.setText.call(this,active.getCueAsHTML())}else{captions.setText.call(this,null)}utils.dispatchEvent.call(this,this.media,"cuechange")},setText:function setText(input){if(!this.supported.ui){return}if(utils.is.element(this.elements.captions)){var content=utils.createElement("span");utils.emptyElement(this.elements.captions);var caption=!utils.is.nullOrUndefined(input)?input:"";if(utils.is.string(caption)){content.textContent=caption.trim()}else{content.appendChild(caption)}this.elements.captions.appendChild(content)}else{this.debug.warn("No captions element to render to")}},show:function show(){if(!utils.is.element(this.elements.buttons.captions)){return}var active=this.storage.get("captions");if(!utils.is.boolean(active)){active=this.config.captions.active}else{this.captions.active=active}if(active){utils.toggleClass(this.elements.container,this.config.classNames.captions.active,true);utils.toggleState(this.elements.buttons.captions,true)}}};var ui={addStyleHook:function addStyleHook(){utils.toggleClass(this.elements.container,this.config.selectors.container.replace(".",""),true);utils.toggleClass(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls:function toggleNativeControls(){var toggle=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(toggle&&this.isHTML5){this.media.setAttribute("controls","")}else{this.media.removeAttribute("controls")}},build:function build(){var _this=this;this.listeners.media();if(!this.supported.ui){this.debug.warn("Basic support only for "+this.provider+" "+this.type);ui.toggleNativeControls.call(this,true);return}if(!utils.is.element(this.elements.controls)){controls.inject.call(this);this.listeners.controls()}if(!utils.is.element(this.elements.controls)){return}ui.toggleNativeControls.call(this);captions.setup.call(this);this.volume=null;this.muted=null;this.speed=null;this.loop=null;this.options.quality=[];ui.timeUpdate.call(this);ui.checkPlaying.call(this);this.ready=true;setTimeout(function(){utils.dispatchEvent.call(_this,_this.media,"ready")},0);ui.setTitle.call(this)},setTitle:function setTitle(){var label=this.config.i18n.play;if(utils.is.string(this.config.title)&&!utils.is.empty(this.config.title)){label+=", "+this.config.title;this.elements.container.setAttribute("aria-label",this.config.title)}if(utils.is.nodeList(this.elements.buttons.play)){Array.from(this.elements.buttons.play).forEach(function(button){button.setAttribute("aria-label",label)})}if(this.isEmbed){var iframe=utils.getElement.call(this,"iframe");if(!utils.is.element(iframe)){return}var title=!utils.is.empty(this.config.title)?this.config.title:"video";iframe.setAttribute("title",this.config.i18n.frameTitle.replace("{title}",title))}},checkPlaying:function checkPlaying(){utils.toggleClass(this.elements.container,this.config.classNames.playing,this.playing);utils.toggleClass(this.elements.container,this.config.classNames.stopped,this.paused);utils.toggleState(this.elements.buttons.play,this.playing);this.toggleControls(!this.playing)},checkLoading:function checkLoading(event){var _this2=this;this.loading=["stalled","waiting"].includes(event.type);clearTimeout(this.timers.loading);this.timers.loading=setTimeout(function(){utils.toggleClass(_this2.elements.container,_this2.config.classNames.loading,_this2.loading);_this2.toggleControls(_this2.loading)},this.loading?250:0)},checkFailed:function checkFailed(){var _this3=this;this.failed=this.media.networkState===3;if(this.failed){utils.toggleClass(this.elements.container,this.config.classNames.loading,false);utils.toggleClass(this.elements.container,this.config.classNames.error,true)}clearTimeout(this.timers.failed);this.timers.loading=setTimeout(function(){utils.toggleClass(_this3.elements.container,_this3.config.classNames.loading,_this3.loading);_this3.toggleControls(_this3.loading)},this.loading?250:0)},updateVolume:function updateVolume(){if(!this.supported.ui){return}if(utils.is.element(this.elements.inputs.volume)){ui.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume)}if(utils.is.element(this.elements.buttons.mute)){utils.toggleState(this.elements.buttons.mute,this.muted||this.volume===0)}},setRange:function setRange(target){var value=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(!utils.is.element(target)){return}target.value=value;controls.updateRangeFill.call(this,target)},setProgress:function setProgress(target,input){var value=utils.is.number(input)?input:0;var progress=utils.is.element(target)?target:this.elements.display.buffer;if(utils.is.element(progress)){progress.value=value;var label=progress.getElementsByTagName("span")[0];if(utils.is.element(label)){label.childNodes[0].nodeValue=value}}},updateProgress:function updateProgress(event){if(!this.supported.ui||!utils.is.event(event)){return}var value=0;if(event){switch(event.type){case"timeupdate":case"seeking":value=utils.getPercentage(this.currentTime,this.duration);if(event.type==="timeupdate"){ui.setRange.call(this,this.elements.inputs.seek,value)}break;case"playing":case"progress":ui.setProgress.call(this,this.elements.display.buffer,this.buffered*100);break;default:break}}},updateTimeDisplay:function updateTimeDisplay(){var target=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var time=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var inverted=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!utils.is.element(target)||!utils.is.number(time)){return}var displayHours=utils.getHours(this.duration)>0;target.textContent=utils.formatTime(time,displayHours,inverted)},timeUpdate:function timeUpdate(event){var invert=!utils.is.element(this.elements.display.duration)&&this.config.invertTime;ui.updateTimeDisplay.call(this,this.elements.display.currentTime,invert?this.duration-this.currentTime:this.currentTime,invert);if(event&&event.type==="timeupdate"&&this.media.seeking){return}ui.updateProgress.call(this,event)},durationUpdate:function durationUpdate(){if(!this.supported.ui){return}var hasDuration=utils.is.element(this.elements.display.duration);if(!hasDuration&&this.config.displayDuration&&this.paused){ui.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration)}if(hasDuration){ui.updateTimeDisplay.call(this,this.elements.display.duration,this.duration)}controls.updateSeekTooltip.call(this)}};var browser$2=utils.getBrowser();var controls={updateRangeFill:function updateRangeFill(target){if(!browser$2.isWebkit){return}var range=utils.is.event(target)?target.target:target;if(!utils.is.element(range)||range.getAttribute("type")!=="range"){return}range.style.setProperty("--value",range.value/range.max*100+"%")},getIconUrl:function getIconUrl(){return{url:this.config.iconUrl,absolute:this.config.iconUrl.indexOf("http")===0||browser$2.isIE&&!window.svg4everybody}},createIcon:function createIcon(type,attributes){var namespace="http://www.w3.org/2000/svg";var iconUrl=controls.getIconUrl.call(this);var iconPath=(!iconUrl.absolute?iconUrl.url:"")+"#"+this.config.iconPrefix;var icon=document.createElementNS(namespace,"svg");utils.setAttributes(icon,utils.extend(attributes,{role:"presentation"}));var use=document.createElementNS(namespace,"use");var path=iconPath+"-"+type;if("href"in use){use.setAttributeNS("http://www.w3.org/1999/xlink","href",path)}else{use.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",path)}icon.appendChild(use);return icon},createLabel:function createLabel(type,attr){var text=this.config.i18n[type];var attributes=Object.assign({},attr);switch(type){case"pip":text="PIP";break;case"airplay":text="AirPlay";break;default:break}if("class"in attributes){attributes.class+=" "+this.config.classNames.hidden}else{attributes.class=this.config.classNames.hidden}return utils.createElement("span",attributes,text)},createBadge:function createBadge(text){if(utils.is.empty(text)){return null}var badge=utils.createElement("span",{class:this.config.classNames.menu.value});badge.appendChild(utils.createElement("span",{class:this.config.classNames.menu.badge},text));return badge},createButton:function createButton(buttonType,attr){var button=utils.createElement("button");var attributes=Object.assign({},attr);var type=buttonType;var toggle=false;var label=void 0;var icon=void 0;var labelPressed=void 0;var iconPressed=void 0;if(!("type"in attributes)){attributes.type="button"}if("class"in attributes){if(attributes.class.includes(this.config.classNames.control)){attributes.class+=" "+this.config.classNames.control}}else{attributes.class=this.config.classNames.control}switch(type){case"play":toggle=true;label="play";labelPressed="pause";icon="play";iconPressed="pause";break;case"mute":toggle=true;label="mute";labelPressed="unmute";icon="volume";iconPressed="muted";break;case"captions":toggle=true;label="enableCaptions";labelPressed="disableCaptions";icon="captions-off";iconPressed="captions-on";break;case"fullscreen":toggle=true;label="enterFullscreen";labelPressed="exitFullscreen";icon="enter-fullscreen";iconPressed="exit-fullscreen";break;case"play-large":attributes.class+=" "+this.config.classNames.control+"--overlaid";type="play";label="play";icon="play";break;default:label=type;icon=type}if(toggle){button.appendChild(controls.createIcon.call(this,iconPressed,{class:"icon--pressed"}));button.appendChild(controls.createIcon.call(this,icon,{class:"icon--not-pressed"}));button.appendChild(controls.createLabel.call(this,labelPressed,{class:"label--pressed"}));button.appendChild(controls.createLabel.call(this,label,{class:"label--not-pressed"}));attributes["aria-pressed"]=false;attributes["aria-label"]=this.config.i18n[label]}else{button.appendChild(controls.createIcon.call(this,icon));button.appendChild(controls.createLabel.call(this,label))}utils.extend(attributes,utils.getAttributesFromSelector(this.config.selectors.buttons[type],attributes));utils.setAttributes(button,attributes);if(type==="play"){if(!utils.is.array(this.elements.buttons[type])){this.elements.buttons[type]=[]}this.elements.buttons[type].push(button)}else{this.elements.buttons[type]=button}return button},createRange:function createRange(type,attributes){var label=utils.createElement("label",{for:attributes.id,class:this.config.classNames.hidden},this.config.i18n[type]);var input=utils.createElement("input",utils.extend(utils.getAttributesFromSelector(this.config.selectors.inputs[type]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off"},attributes));this.elements.inputs[type]=input;controls.updateRangeFill.call(this,input);return{label:label,input:input}},createProgress:function createProgress(type,attributes){var progress=utils.createElement("progress",utils.extend(utils.getAttributesFromSelector(this.config.selectors.display[type]),{min:0,max:100,value:0},attributes));if(type!=="volume"){progress.appendChild(utils.createElement("span",null,"0"));var suffix="";switch(type){case"played":suffix=this.config.i18n.played;break;case"buffer":suffix=this.config.i18n.buffered;break;default:break}progress.textContent="% "+suffix.toLowerCase()}this.elements.display[type]=progress;return progress},createTime:function createTime(type){var container=utils.createElement("div",{class:"plyr__time"});container.appendChild(utils.createElement("span",{class:this.config.classNames.hidden},this.config.i18n[type]));container.appendChild(utils.createElement("span",utils.getAttributesFromSelector(this.config.selectors.display[type]),"00:00"));this.elements.display[type]=container;return container},createMenuItem:function createMenuItem(value,list,type,title){var badge=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;var checked=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;var item=utils.createElement("li");var label=utils.createElement("label",{class:this.config.classNames.control});var radio=utils.createElement("input",utils.extend(utils.getAttributesFromSelector(this.config.selectors.inputs[type]),{type:"radio",name:"plyr-"+type,value:value,checked:checked,class:"plyr__sr-only"}));var faux=utils.createElement("span",{"aria-hidden":true});label.appendChild(radio);label.appendChild(faux);label.insertAdjacentHTML("beforeend",title);if(utils.is.element(badge)){label.appendChild(badge)}item.appendChild(label);list.appendChild(item)},updateSeekTooltip:function updateSeekTooltip(event){if(!this.config.tooltips.seek||!utils.is.element(this.elements.inputs.seek)||!utils.is.element(this.elements.display.seekTooltip)||this.duration===0){return}var percent=0;var clientRect=this.elements.inputs.seek.getBoundingClientRect();var visible=this.config.classNames.tooltip+"--visible";if(utils.is.event(event)){percent=100/clientRect.width*(event.pageX-clientRect.left)}else if(utils.hasClass(this.elements.display.seekTooltip,visible)){percent=parseFloat(this.elements.display.seekTooltip.style.left,10)}else{return}if(percent<0){percent=0}else if(percent>100){percent=100}ui.updateTimeDisplay.call(this,this.elements.display.seekTooltip,this.duration/100*percent);this.elements.display.seekTooltip.style.left=percent+"%";if(utils.is.event(event)&&["mouseenter","mouseleave"].includes(event.type)){utils.toggleClass(this.elements.display.seekTooltip,visible,event.type==="mouseenter")}},toggleTab:function toggleTab(setting,toggle){var tab=this.elements.settings.tabs[setting];var pane=this.elements.settings.panes[setting];utils.toggleHidden(tab,!toggle);utils.toggleHidden(pane,!toggle)},setQualityMenu:function setQualityMenu(options){var _this=this;if(!utils.is.element(this.elements.settings.panes.quality)){return}var type="quality";var list=this.elements.settings.panes.quality.querySelector("ul");if(utils.is.array(options)){this.options.quality=options.filter(function(quality){return _this.config.quality.options.includes(quality)})}else{this.options.quality=this.config.quality.options}var toggle=!utils.is.empty(this.options.quality)&&this.isYouTube;controls.toggleTab.call(this,type,toggle);if(!toggle){return}utils.emptyElement(list);var getBadge=function getBadge(quality){var label="";switch(quality){case"hd2160":label="4K";break;case"hd1440":label="WQHD";break;case"hd1080":label="HD";break;case"hd720":label="HD";break;default:break}if(!label.length){return null}return controls.createBadge.call(_this,label)};this.options.quality.forEach(function(quality){return controls.createMenuItem.call(_this,quality,list,type,controls.getLabel.call(_this,"quality",quality),getBadge(quality))});controls.updateSetting.call(this,type,list)},getLabel:function getLabel(setting,value){switch(setting){case"speed":return value===1?"Normal":value+"&times;";case"quality":switch(value){case"hd2160":return"2160P";case"hd1440":return"1440P";case"hd1080":return"1080P";case"hd720":return"720P";case"large":return"480P";case"medium":return"360P";case"small":return"240P";case"tiny":return"Tiny";case"default":return"Auto";default:return value}case"captions":return controls.getLanguage.call(this);default:return null}},updateSetting:function updateSetting(setting,container){var pane=this.elements.settings.panes[setting];var value=null;var list=container;switch(setting){case"captions":value=this.captions.active?this.captions.language:"";break;default:value=this[setting];if(utils.is.empty(value)){value=this.config[setting].default}if(!this.options[setting].includes(value)){this.debug.warn("Unsupported value of '"+value+"' for "+setting);return}if(!this.config[setting].options.includes(value)){this.debug.warn("Disabled value of '"+value+"' for "+setting);return}break}if(!utils.is.element(list)){list=pane&&pane.querySelector("ul")}if(!utils.is.empty(value)){var label=this.elements.settings.tabs[setting].querySelector("."+this.config.classNames.menu.value);label.innerHTML=controls.getLabel.call(this,setting,value)}var target=list&&list.querySelector('input[value="'+value+'"]');if(utils.is.element(target)){target.checked=true}},getLanguage:function getLanguage(){if(!this.supported.ui){return null}if(!support.textTracks||!captions.getTracks.call(this).length){return this.config.i18n.none}if(this.captions.active){var currentTrack=captions.getCurrentTrack.call(this);if(utils.is.track(currentTrack)){return currentTrack.label}}return this.config.i18n.disabled},setCaptionsMenu:function setCaptionsMenu(){var _this2=this;var type="captions";var list=this.elements.settings.panes.captions.querySelector("ul");var hasTracks=captions.getTracks.call(this).length;controls.toggleTab.call(this,type,hasTracks);utils.emptyElement(list);if(!hasTracks){return}var tracks=captions.getTracks.call(this).map(function(track){return{language:track.language,label:!utils.is.empty(track.label)?track.label:track.language.toUpperCase()}});tracks.unshift({language:"",label:this.config.i18n.none});tracks.forEach(function(track){controls.createMenuItem.call(_this2,track.language,list,"language",track.label||track.language,controls.createBadge.call(_this2,track.language.toUpperCase()),track.language.toLowerCase()===_this2.captions.language.toLowerCase())});controls.updateSetting.call(this,type,list)},setSpeedMenu:function setSpeedMenu(){var _this3=this;if(!utils.is.element(this.elements.settings.panes.speed)){return}var type="speed";if(!utils.is.array(this.options.speed)||!this.options.speed.length){this.options.speed=[.5,.75,1,1.25,1.5,1.75,2]}this.options.speed=this.options.speed.filter(function(speed){return _this3.config.speed.options.includes(speed)});var toggle=!utils.is.empty(this.options.speed);controls.toggleTab.call(this,type,toggle);if(!toggle){return}var list=this.elements.settings.panes.speed.querySelector("ul");utils.toggleHidden(this.elements.settings.tabs.speed,false);utils.toggleHidden(this.elements.settings.panes.speed,false);utils.emptyElement(list);this.options.speed.forEach(function(speed){return controls.createMenuItem.call(_this3,speed,list,type,controls.getLabel.call(_this3,"speed",speed))});controls.updateSetting.call(this,type,list)},toggleMenu:function toggleMenu(event){var form=this.elements.settings.form;var button=this.elements.buttons.settings;if(!utils.is.element(form)||!utils.is.element(button)){return}var show=utils.is.boolean(event)?event:utils.is.element(form)&&form.getAttribute("aria-hidden")==="true";if(utils.is.event(event)){var isMenuItem=utils.is.element(form)&&form.contains(event.target);var isButton=event.target===this.elements.buttons.settings;if(isMenuItem||!isMenuItem&&!isButton&&show){return}if(isButton){event.stopPropagation()}}if(utils.is.element(button)){button.setAttribute("aria-expanded",show)}if(utils.is.element(form)){form.setAttribute("aria-hidden",!show);utils.toggleClass(this.elements.container,this.config.classNames.menu.open,show);if(show){form.removeAttribute("tabindex")}else{form.setAttribute("tabindex",-1)}}},getTabSize:function getTabSize(tab){var clone=tab.cloneNode(true);clone.style.position="absolute";clone.style.opacity=0;clone.setAttribute("aria-hidden",false);Array.from(clone.querySelectorAll("input[name]")).forEach(function(input){var name=input.getAttribute("name");input.setAttribute("name",name+"-clone")});tab.parentNode.appendChild(clone);var width=clone.scrollWidth;var height=clone.scrollHeight;utils.removeElement(clone);return{width:width,height:height}},showTab:function showTab(event){var menu=this.elements.settings.menu;var tab=event.target;var show=tab.getAttribute("aria-expanded")==="false";var pane=document.getElementById(tab.getAttribute("aria-controls"));if(!utils.is.element(pane)){return}var isTab=pane.getAttribute("role")==="tabpanel";if(!isTab){return}var current=menu.querySelector('[role="tabpanel"][aria-hidden="false"]');var container=current.parentNode;Array.from(menu.querySelectorAll('[aria-controls="'+current.getAttribute("id")+'"]')).forEach(function(toggle){toggle.setAttribute("aria-expanded",false)});if(support.transitions&&!support.reducedMotion){container.style.width=current.scrollWidth+"px";container.style.height=current.scrollHeight+"px";var size=controls.getTabSize.call(this,pane);var restore=function restore(e){if(e.target!==container||!["width","height"].includes(e.propertyName)){return}container.style.width="";container.style.height="";utils.off(container,utils.transitionEndEvent,restore)};utils.on(container,utils.transitionEndEvent,restore);container.style.width=size.width+"px";container.style.height=size.height+"px"}current.setAttribute("aria-hidden",true);current.setAttribute("tabindex",-1);pane.setAttribute("aria-hidden",!show);tab.setAttribute("aria-expanded",show);pane.removeAttribute("tabindex");pane.querySelectorAll("button:not(:disabled), input:not(:disabled), [tabindex]")[0].focus()},create:function create(data){var _this4=this;if(utils.is.empty(this.config.controls)){return null}var container=utils.createElement("div",utils.getAttributesFromSelector(this.config.selectors.controls.wrapper));if(this.config.controls.includes("restart")){container.appendChild(controls.createButton.call(this,"restart"))}if(this.config.controls.includes("rewind")){container.appendChild(controls.createButton.call(this,"rewind"))}if(this.config.controls.includes("play")){container.appendChild(controls.createButton.call(this,"play"))}if(this.config.controls.includes("fast-forward")){container.appendChild(controls.createButton.call(this,"fastForward"))}if(this.config.controls.includes("progress")){var progress=utils.createElement("div",utils.getAttributesFromSelector(this.config.selectors.progress));var seek=controls.createRange.call(this,"seek",{id:"plyr-seek-"+data.id});progress.appendChild(seek.label);progress.appendChild(seek.input);progress.appendChild(controls.createProgress.call(this,"buffer"));if(this.config.tooltips.seek){var tooltip=utils.createElement("span",{role:"tooltip",class:this.config.classNames.tooltip},"00:00");progress.appendChild(tooltip);this.elements.display.seekTooltip=tooltip}this.elements.progress=progress;container.appendChild(this.elements.progress)}if(this.config.controls.includes("current-time")){container.appendChild(controls.createTime.call(this,"currentTime"))}if(this.config.controls.includes("duration")){container.appendChild(controls.createTime.call(this,"duration"))}if(this.config.controls.includes("mute")){container.appendChild(controls.createButton.call(this,"mute"))}if(this.config.controls.includes("volume")){var volume=utils.createElement("div",{class:"plyr__volume"});var attributes={max:1,step:.05,value:this.config.volume};var range=controls.createRange.call(this,"volume",utils.extend(attributes,{id:"plyr-volume-"+data.id}));volume.appendChild(range.label);volume.appendChild(range.input);this.elements.volume=volume;container.appendChild(volume)}if(this.config.controls.includes("captions")){container.appendChild(controls.createButton.call(this,"captions"))}if(this.config.controls.includes("settings")&&!utils.is.empty(this.config.settings)){var menu=utils.createElement("div",{class:"plyr__menu"});menu.appendChild(controls.createButton.call(this,"settings",{id:"plyr-settings-toggle-"+data.id,"aria-haspopup":true,"aria-controls":"plyr-settings-"+data.id,"aria-expanded":false}));var form=utils.createElement("form",{class:"plyr__menu__container",id:"plyr-settings-"+data.id,"aria-hidden":true,"aria-labelled-by":"plyr-settings-toggle-"+data.id,role:"tablist",tabindex:-1});var inner=utils.createElement("div");var home=utils.createElement("div",{id:"plyr-settings-"+data.id+"-home","aria-hidden":false,"aria-labelled-by":"plyr-settings-toggle-"+data.id,role:"tabpanel"});var tabs=utils.createElement("ul",{role:"tablist"});this.config.settings.forEach(function(type){var tab=utils.createElement("li",{role:"tab",hidden:""});var button=utils.createElement("button",utils.extend(utils.getAttributesFromSelector(_this4.config.selectors.buttons.settings),{type:"button",class:_this4.config.classNames.control+" "+_this4.config.classNames.control+"--forward",id:"plyr-settings-"+data.id+"-"+type+"-tab","aria-haspopup":true,"aria-controls":"plyr-settings-"+data.id+"-"+type,"aria-expanded":false}),_this4.config.i18n[type]);var value=utils.createElement("span",{class:_this4.config.classNames.menu.value});value.innerHTML=data[type];button.appendChild(value);tab.appendChild(button);tabs.appendChild(tab);_this4.elements.settings.tabs[type]=tab});home.appendChild(tabs);inner.appendChild(home);this.config.settings.forEach(function(type){var pane=utils.createElement("div",{id:"plyr-settings-"+data.id+"-"+type,"aria-hidden":true,"aria-labelled-by":"plyr-settings-"+data.id+"-"+type+"-tab",role:"tabpanel",tabindex:-1,hidden:""});var back=utils.createElement("button",{type:"button",class:_this4.config.classNames.control+" "+_this4.config.classNames.control+"--back","aria-haspopup":true,"aria-controls":"plyr-settings-"+data.id+"-home","aria-expanded":false},_this4.config.i18n[type]);pane.appendChild(back);var options=utils.createElement("ul");pane.appendChild(options);inner.appendChild(pane);_this4.elements.settings.panes[type]=pane});form.appendChild(inner);menu.appendChild(form);container.appendChild(menu);this.elements.settings.form=form;this.elements.settings.menu=menu}if(this.config.controls.includes("pip")&&support.pip){container.appendChild(controls.createButton.call(this,"pip"))}if(this.config.controls.includes("airplay")&&support.airplay){container.appendChild(controls.createButton.call(this,"airplay"))}if(this.config.controls.includes("fullscreen")){container.appendChild(controls.createButton.call(this,"fullscreen"))}if(this.config.controls.includes("play-large")){this.elements.container.appendChild(controls.createButton.call(this,"play-large"))}this.elements.controls=container;if(this.config.controls.includes("settings")&&this.config.settings.includes("speed")){controls.setSpeedMenu.call(this)}return container},inject:function inject(){var _this5=this;if(this.config.loadSprite){var icon=controls.getIconUrl.call(this);if(icon.absolute){utils.loadSprite(icon.url,"sprite-plyr")}}this.id=Math.floor(Math.random()*1e4);var container=null;this.elements.controls=null;if(utils.is.string(this.config.controls)||utils.is.element(this.config.controls)){container=this.config.controls}else if(utils.is.function(this.config.controls)){container=this.config.controls({id:this.id,seektime:this.config.seekTime,title:this.config.title})}else{container=controls.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:controls.getLanguage.call(this)})}var target=void 0;if(utils.is.string(this.config.selectors.controls.container)){target=document.querySelector(this.config.selectors.controls.container)}if(!utils.is.element(target)){target=this.elements.container}if(utils.is.element(container)){target.appendChild(container)}else{target.insertAdjacentHTML("beforeend",container)}if(!utils.is.element(this.elements.controls)){utils.findElements.call(this)}if(window.navigator.userAgent.includes("Edge")){utils.repaint(target)}if(this.config.tooltips.controls){var labels=utils.getElements.call(this,[this.config.selectors.controls.wrapper," ",this.config.selectors.labels," .",this.config.classNames.hidden].join(""));Array.from(labels).forEach(function(label){utils.toggleClass(label,_this5.config.classNames.hidden,false);utils.toggleClass(label,_this5.config.classNames.tooltip,true);label.setAttribute("role","tooltip")})}}};var browser$1=utils.getBrowser();var Listeners=function(){function Listeners(player){classCallCheck(this,Listeners);this.player=player;this.lastKey=null;this.handleKey=this.handleKey.bind(this);this.toggleMenu=this.toggleMenu.bind(this)}createClass(Listeners,[{key:"handleKey",value:function handleKey(event){var _this=this;var code=event.keyCode?event.keyCode:event.which;var pressed=event.type==="keydown";var repeat=pressed&&code===this.lastKey;if(event.altKey||event.ctrlKey||event.metaKey||event.shiftKey){return}if(!utils.is.number(code)){return}var seekByKey=function seekByKey(){_this.player.currentTime=_this.player.duration/10*(code-48)};if(pressed){var preventDefault=[48,49,50,51,52,53,54,56,57,32,75,38,40,77,39,37,70,67,73,76,79];var focused=utils.getFocusElement();if(utils.is.element(focused)&&utils.matches(focused,this.player.config.selectors.editable)){return}if(preventDefault.includes(code)){event.preventDefault();event.stopPropagation()}switch(code){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if(!repeat){seekByKey()}break;case 32:case 75:if(!repeat){this.player.togglePlay()}break;case 38:this.player.increaseVolume(.1);break;case 40:this.player.decreaseVolume(.1);break;case 77:if(!repeat){this.player.muted=!this.player.muted}break;case 39:this.player.forward();break;case 37:this.player.rewind();break;case 70:this.player.fullscreen.toggle();break;case 67:if(!repeat){this.player.toggleCaptions()}break;case 76:this.player.loop=!this.player.loop;break;default:break}if(!this.player.fullscreen.enabled&&this.player.fullscreen.active&&code===27){this.player.fullscreen.toggle()}this.lastKey=code}else{this.lastKey=null}}},{key:"toggleMenu",value:function toggleMenu(event){controls.toggleMenu.call(this.player,event)}},{key:"global",value:function global(){var toggle=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(this.player.config.keyboard.global){utils.toggleListener(window,"keydown keyup",this.handleKey,toggle,false)}utils.toggleListener(document.body,"click",this.toggleMenu,toggle)}},{key:"container",value:function container(){var _this2=this;if(!this.player.config.keyboard.global&&this.player.config.keyboard.focused){utils.on(this.player.elements.container,"keydown keyup",this.handleKey,false)}utils.on(this.player.elements.container,"focusout",function(event){utils.toggleClass(event.target,_this2.player.config.classNames.tabFocus,false)});utils.on(this.player.elements.container,"keydown",function(event){if(event.keyCode!==9){return}setTimeout(function(){utils.toggleClass(utils.getFocusElement(),_this2.player.config.classNames.tabFocus,true)},0)});if(this.player.config.hideControls){utils.on(this.player.elements.container,"mouseenter mouseleave mousemove touchstart touchend touchmove enterfullscreen exitfullscreen",function(event){_this2.player.toggleControls(event)})}}},{key:"media",value:function media(){var _this3=this;utils.on(this.player.media,"timeupdate seeking",function(event){return ui.timeUpdate.call(_this3.player,event)});utils.on(this.player.media,"durationchange loadedmetadata",function(event){return ui.durationUpdate.call(_this3.player,event)});utils.on(this.player.media,"loadeddata",function(){utils.toggleHidden(_this3.player.elements.volume,!_this3.player.hasAudio);utils.toggleHidden(_this3.player.elements.buttons.mute,!_this3.player.hasAudio)});utils.on(this.player.media,"ended",function(){if(_this3.player.isHTML5&&_this3.player.isVideo&&_this3.player.config.showPosterOnEnd){_this3.player.restart();_this3.player.media.load()}});utils.on(this.player.media,"progress playing",function(event){return ui.updateProgress.call(_this3.player,event)});utils.on(this.player.media,"volumechange",function(event){return ui.updateVolume.call(_this3.player,event)});utils.on(this.player.media,"playing play pause ended emptied",function(event){return ui.checkPlaying.call(_this3.player,event)});utils.on(this.player.media,"waiting canplay seeked playing",function(event){return ui.checkLoading.call(_this3.player,event)});if(this.player.supported.ui&&this.player.config.clickToPlay&&!this.player.isAudio){var wrapper=utils.getElement.call(this.player,"."+this.player.config.classNames.video);if(!utils.is.element(wrapper)){return}utils.on(wrapper,"click",function(){if(_this3.player.config.hideControls&&support.touch&&!_this3.player.paused){return}if(_this3.player.paused){_this3.player.play()}else if(_this3.player.ended){_this3.player.restart();_this3.player.play()}else{_this3.player.pause()}})}if(this.player.supported.ui&&this.player.config.disableContextMenu){utils.on(this.player.media,"contextmenu",function(event){event.preventDefault()},false)}utils.on(this.player.media,"volumechange",function(){_this3.player.storage.set({volume:_this3.player.volume,muted:_this3.player.muted})});utils.on(this.player.media,"ratechange",function(){controls.updateSetting.call(_this3.player,"speed");_this3.player.storage.set({speed:_this3.player.speed})});utils.on(this.player.media,"qualitychange",function(){controls.updateSetting.call(_this3.player,"quality");_this3.player.storage.set({quality:_this3.player.quality})});utils.on(this.player.media,"languagechange",function(){controls.updateSetting.call(_this3.player,"captions");_this3.player.storage.set({language:_this3.player.language})});utils.on(this.player.media,"captionsenabled captionsdisabled",function(){controls.updateSetting.call(_this3.player,"captions");_this3.player.storage.set({captions:_this3.player.captions.active})});utils.on(this.player.media,this.player.config.events.concat(["keyup","keydown"]).join(" "),function(event){var detail={};if(event.type==="error"){detail=_this3.player.media.error}utils.dispatchEvent.call(_this3.player,_this3.player.elements.container,event.type,true,detail)})}},{key:"controls",value:function controls$$1(){var _this4=this;var inputEvent=browser$1.isIE?"change":"input";var proxy=function proxy(event,handlerKey,defaultHandler){var customHandler=_this4.player.config.listeners[handlerKey];if(utils.is.function(customHandler)){customHandler.call(_this4.player,event)}if(!event.defaultPrevented&&utils.is.function(defaultHandler)){defaultHandler.call(_this4.player,event)}};utils.on(this.player.elements.buttons.play,"click",function(event){return proxy(event,"play",function(){_this4.player.togglePlay()})});utils.on(this.player.elements.buttons.restart,"click",function(event){return proxy(event,"restart",function(){_this4.player.restart()})});utils.on(this.player.elements.buttons.rewind,"click",function(event){return proxy(event,"rewind",function(){_this4.player.rewind()})});utils.on(this.player.elements.buttons.forward,"click",function(event){return proxy(event,"forward",function(){_this4.player.forward()})});utils.on(this.player.elements.buttons.mute,"click",function(event){return proxy(event,"mute",function(){_this4.player.muted=!_this4.player.muted})});utils.on(this.player.elements.buttons.captions,"click",function(event){return proxy(event,"captions",function(){_this4.player.toggleCaptions()})});utils.on(this.player.elements.buttons.fullscreen,"click",function(event){return proxy(event,"fullscreen",function(){_this4.player.fullscreen.toggle()})});utils.on(this.player.elements.buttons.pip,"click",function(event){return proxy(event,"pip",function(){_this4.player.pip="toggle"})});utils.on(this.player.elements.buttons.airplay,"click",function(event){return proxy(event,"airplay",function(){_this4.player.airplay()})});utils.on(this.player.elements.buttons.settings,"click",function(event){controls.toggleMenu.call(_this4.player,event)});utils.on(this.player.elements.settings.form,"click",function(event){event.stopPropagation();if(utils.matches(event.target,_this4.player.config.selectors.inputs.language)){proxy(event,"language",function(){_this4.player.language=event.target.value})}else if(utils.matches(event.target,_this4.player.config.selectors.inputs.quality)){proxy(event,"quality",function(){_this4.player.quality=event.target.value})}else if(utils.matches(event.target,_this4.player.config.selectors.inputs.speed)){proxy(event,"speed",function(){_this4.player.speed=parseFloat(event.target.value)})}else{controls.showTab.call(_this4.player,event)}});utils.on(this.player.elements.inputs.seek,inputEvent,function(event){return proxy(event,"seek",function(){_this4.player.currentTime=event.target.value/event.target.max*_this4.player.duration})});if(this.player.config.toggleInvert&&!utils.is.element(this.player.elements.display.duration)){utils.on(this.player.elements.display.currentTime,"click",function(){if(_this4.player.currentTime===0){return}_this4.player.config.invertTime=!_this4.player.config.invertTime;ui.timeUpdate.call(_this4.player)})}utils.on(this.player.elements.inputs.volume,inputEvent,function(event){return proxy(event,"volume",function(){_this4.player.volume=event.target.value})});if(browser$1.isWebkit){utils.on(utils.getElements.call(this.player,'input[type="range"]'),"input",function(event){controls.updateRangeFill.call(_this4.player,event.target)})}utils.on(this.player.elements.progress,"mouseenter mouseleave mousemove",function(event){return controls.updateSeekTooltip.call(_this4.player,event)});if(this.player.config.hideControls){utils.on(this.player.elements.controls,"mouseenter mouseleave",function(event){_this4.player.elements.controls.hover=event.type==="mouseenter"});utils.on(this.player.elements.controls,"mousedown mouseup touchstart touchend touchcancel",function(event){_this4.player.elements.controls.pressed=["mousedown","touchstart"].includes(event.type)});utils.on(this.player.elements.controls,"focusin focusout",function(event){_this4.player.toggleControls(event)})}utils.on(this.player.elements.inputs.volume,"wheel",function(event){return proxy(event,"volume",function(){var inverted=event.webkitDirectionInvertedFromDevice;var step=1/50;var direction=0;if(event.deltaY<0||event.deltaX>0){if(inverted){_this4.player.decreaseVolume(step);direction=-1}else{_this4.player.increaseVolume(step);direction=1}}if(event.deltaY>0||event.deltaX<0){if(inverted){_this4.player.increaseVolume(step);direction=1}else{_this4.player.decreaseVolume(step);direction=-1}}if(direction===1&&_this4.player.media.volume<1||direction===-1&&_this4.player.media.volume>0){event.preventDefault()}})},false)}},{key:"clear",value:function clear(){this.global(false)}}]);return Listeners}();var Storage=function(){function Storage(player){classCallCheck(this,Storage);this.enabled=player.config.storage.enabled;this.key=player.config.storage.key}createClass(Storage,[{key:"get",value:function get$$1(key){if(!Storage.supported){return null}var store=window.localStorage.getItem(this.key);if(utils.is.empty(store)){return null}var json=JSON.parse(store);return utils.is.string(key)&&key.length?json[key]:json}},{key:"set",value:function set$$1(object){if(!Storage.supported||!this.enabled){return}if(!utils.is.object(object)){return}var storage=this.get();if(utils.is.empty(storage)){storage={}}utils.extend(storage,object);window.localStorage.setItem(this.key,JSON.stringify(storage))}}],[{key:"supported",get:function get$$1(){try{if(!("localStorage"in window)){return false}var test="___test";window.localStorage.setItem(test,test);window.localStorage.removeItem(test);return true}catch(e){return false}}}]);return Storage}();var Ads=function(){function Ads(player){var _this=this;classCallCheck(this,Ads);this.player=player;this.publisherId=player.config.ads.publisherId;this.enabled=player.isHTML5&&player.isVideo&&player.config.ads.enabled&&utils.is.string(this.publisherId)&&this.publisherId.length;this.playing=false;this.initialized=false;this.elements={container:null,displayContainer:null};this.manager=null;this.loader=null;this.cuePoints=null;this.events={};this.safetyTimer=null;this.countdownTimer=null;this.managerPromise=new Promise(function(resolve,reject){_this.on("loaded",resolve);_this.on("error",reject)});this.load()}createClass(Ads,[{key:"load",value:function load(){var _this2=this;if(this.enabled){if(!utils.is.object(window.google)||!utils.is.object(window.google.ima)){utils.loadScript(this.player.config.urls.googleIMA.api).then(function(){_this2.ready()}).catch(function(){_this2.trigger("error",new Error("Google IMA SDK failed to load"))})}else{this.ready()}}}},{key:"ready",value:function ready(){var _this3=this;this.startSafetyTimer(12e3,"ready()");this.managerPromise.then(function(){_this3.clearSafetyTimer("onAdsManagerLoaded()")});this.listeners();this.setupIMA()}},{key:"setupIMA",value:function setupIMA(){this.elements.container=utils.createElement("div",{class:this.player.config.classNames.ads});this.player.elements.container.appendChild(this.elements.container);google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);google.ima.settings.setLocale(this.player.config.ads.language);this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container);this.requestAds()}},{key:"requestAds",value:function requestAds(){var _this4=this;var container=this.player.elements.container;try{this.loader=new google.ima.AdsLoader(this.elements.displayContainer);this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(event){return _this4.onAdsManagerLoaded(event)},false);this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(error){return _this4.onAdError(error)},false);var request=new google.ima.AdsRequest;request.adTagUrl=this.tagUrl;request.linearAdSlotWidth=container.offsetWidth;request.linearAdSlotHeight=container.offsetHeight;request.nonLinearAdSlotWidth=container.offsetWidth;request.nonLinearAdSlotHeight=container.offsetHeight;request.forceNonLinearFullSlot=false;this.loader.requestAds(request)}catch(e){this.onAdError(e)}}},{key:"pollCountdown",value:function pollCountdown(){var _this5=this;var start=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!start){clearInterval(this.countdownTimer);this.elements.container.removeAttribute("data-badge-text");return}var update=function update(){var time=utils.formatTime(Math.max(_this5.manager.getRemainingTime(),0));var label=_this5.player.config.i18n.advertisement+" - "+time;_this5.elements.container.setAttribute("data-badge-text",label)};this.countdownTimer=setInterval(update,100)}},{key:"onAdsManagerLoaded",value:function onAdsManagerLoaded(event){var _this6=this;var settings=new google.ima.AdsRenderingSettings;settings.restoreCustomPlaybackStateOnAdBreakComplete=true;settings.enablePreloading=true;this.manager=event.getAdsManager(this.player,settings);this.cuePoints=this.manager.getCuePoints();this.cuePoints.forEach(function(cuePoint){if(cuePoint!==0&&cuePoint!==-1&&cuePoint<_this6.player.duration){var seekElement=_this6.player.elements.progress;if(seekElement){var cuePercentage=100/_this6.player.duration*cuePoint;var cue=utils.createElement("span",{class:_this6.player.config.classNames.cues});cue.style.left=cuePercentage.toString()+"%";seekElement.appendChild(cue)}}});this.manager.setVolume(this.player.volume);this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(error){return _this6.onAdError(error)});Object.keys(google.ima.AdEvent.Type).forEach(function(type){_this6.manager.addEventListener(google.ima.AdEvent.Type[type],function(event){return _this6.onAdEvent(event)})});this.trigger("loaded")}},{key:"onAdEvent",value:function onAdEvent(event){var _this7=this;var container=this.player.elements.container;var ad=event.getAd();var dispatchEvent=function dispatchEvent(type){var event="ads"+type.replace(/_/g,"").toLowerCase();utils.dispatchEvent.call(_this7.player,_this7.player.media,event)};switch(event.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded");dispatchEvent(event.type);this.pollCountdown(true);if(!ad.isLinear()){ad.width=container.offsetWidth;ad.height=container.offsetHeight}break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:dispatchEvent(event.type);this.loadAds();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:dispatchEvent(event.type);this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:dispatchEvent(event.type);this.pollCountdown();this.resumeContent();break;case google.ima.AdEvent.Type.STARTED:case google.ima.AdEvent.Type.MIDPOINT:case google.ima.AdEvent.Type.COMPLETE:case google.ima.AdEvent.Type.IMPRESSION:case google.ima.AdEvent.Type.CLICK:dispatchEvent(event.type);break;default:break}}},{key:"onAdError",value:function onAdError(event){this.cancel();this.player.debug.warn("Ads error",event)}},{key:"listeners",value:function listeners(){var _this8=this;var container=this.player.elements.container;var time=void 0;this.player.on("ended",function(){_this8.loader.contentComplete()});this.player.on("seeking",function(){time=_this8.player.currentTime;return time});this.player.on("seeked",function(){var seekedTime=_this8.player.currentTime;_this8.cuePoints.forEach(function(cuePoint,index){if(time<cuePoint&&cuePoint<seekedTime){_this8.manager.discardAdBreak();_this8.cuePoints.splice(index,1)}})});window.addEventListener("resize",function(){_this8.manager.resize(container.offsetWidth,container.offsetHeight,google.ima.ViewMode.NORMAL)})}},{key:"play",value:function play(){var _this9=this;var container=this.player.elements.container;if(!this.managerPromise){this.resumeContent()}this.managerPromise.then(function(){_this9.elements.displayContainer.initialize();try{if(!_this9.initialized){_this9.manager.init(container.offsetWidth,container.offsetHeight,google.ima.ViewMode.NORMAL);_this9.manager.start()}_this9.initialized=true}catch(adError){_this9.onAdError(adError)}}).catch(function(){})}},{key:"resumeContent",value:function resumeContent(){this.elements.container.style.zIndex="";this.playing=false;if(this.player.currentTime<this.player.duration){this.player.play()}}},{key:"pauseContent",value:function pauseContent(){this.elements.container.style.zIndex=3;this.playing=true;this.player.pause()}},{key:"cancel",value:function cancel(){if(this.initialized){this.resumeContent()}this.trigger("error");this.loadAds()}},{key:"loadAds",value:function loadAds(){var _this10=this;this.managerPromise.then(function(){if(_this10.manager){_this10.manager.destroy()}_this10.managerPromise=new Promise(function(resolve){_this10.on("loaded",resolve);_this10.player.debug.log(_this10.manager)});_this10.requestAds()}).catch(function(){})}},{key:"trigger",value:function trigger(event){var _this11=this;for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}var handlers=this.events[event];if(utils.is.array(handlers)){handlers.forEach(function(handler){if(utils.is.function(handler)){handler.apply(_this11,args)}})}}},{key:"on",value:function on(event,callback){if(!utils.is.array(this.events[event])){this.events[event]=[]}this.events[event].push(callback);return this}},{key:"startSafetyTimer",value:function startSafetyTimer(time,from){var _this12=this;this.player.debug.log("Safety timer invoked from: "+from);this.safetyTimer=setTimeout(function(){_this12.cancel();_this12.clearSafetyTimer("startSafetyTimer()")},time)}},{key:"clearSafetyTimer",value:function clearSafetyTimer(from){if(!utils.is.nullOrUndefined(this.safetyTimer)){this.player.debug.log("Safety timer cleared from: "+from);clearTimeout(this.safetyTimer);this.safetyTimer=null}}},{key:"tagUrl",get:function get$$1(){var params={AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:this.publisherId};var base="https://go.aniview.com/api/adserver6/vast/";return base+"?"+utils.buildUrlParams(params)}}]);return Ads}();var youtube={setup:function setup(){var _this=this;utils.toggleClass(this.elements.wrapper,this.config.classNames.embed,true);youtube.setAspectRatio.call(this);if(utils.is.object(window.YT)&&utils.is.function(window.YT.Player)){youtube.ready.call(this)}else{utils.loadScript(this.config.urls.youtube.api).catch(function(error){_this.debug.warn("YouTube API failed to load",error)});window.onYouTubeReadyCallbacks=window.onYouTubeReadyCallbacks||[];window.onYouTubeReadyCallbacks.push(function(){youtube.ready.call(_this)});window.onYouTubeIframeAPIReady=function(){window.onYouTubeReadyCallbacks.forEach(function(callback){callback()})}}},getTitle:function getTitle(videoId){var _this2=this;if(utils.is.function(this.embed.getVideoData)){var _embed$getVideoData=this.embed.getVideoData(),title=_embed$getVideoData.title;if(utils.is.empty(title)){this.config.title=title;ui.setTitle.call(this);return}}var key=this.config.keys.google;if(utils.is.string(key)&&!utils.is.empty(key)){var url="https://www.googleapis.com/youtube/v3/videos?id="+videoId+"&key="+key+"&fields=items(snippet(title))&part=snippet";utils.fetch(url).then(function(result){if(utils.is.object(result)){_this2.config.title=result.items[0].snippet.title;ui.setTitle.call(_this2)}}).catch(function(){})}},setAspectRatio:function setAspectRatio(){var ratio=this.config.ratio.split(":");this.elements.wrapper.style.paddingBottom=100/ratio[0]*ratio[1]+"%"},ready:function ready(){var player=this;var currentId=player.media.getAttribute("id");if(!utils.is.empty(currentId)&&currentId.startsWith("youtube-")){return}var source=player.media.getAttribute("src");if(utils.is.empty(source)){source=player.media.getAttribute(this.config.attributes.embed.id)}var videoId=utils.parseYouTubeId(source);var id=utils.generateId(player.provider);var container=utils.createElement("div",{id:id});player.media=utils.replaceElement(container,player.media);player.embed=new window.YT.Player(id,{videoId:videoId,playerVars:{autoplay:player.config.autoplay?1:0,controls:player.supported.ui?0:1,rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,disablekb:1,playsinline:1,widget_referrer:window?window.location.href:null,cc_load_policy:player.captions.active?1:0,cc_lang_pref:player.config.captions.language},events:{onError:function onError(event){if(utils.is.object(player.media.error)){return}var detail={code:event.data};switch(event.data){case 2:detail.message="The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.";break;case 5:detail.message="The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.";break;case 100:detail.message="The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.";break;case 101:case 150:detail.message="The owner of the requested video does not allow it to be played in embedded players.";break;default:detail.message="An unknown error occured";break}player.media.error=detail;utils.dispatchEvent.call(player,player.media,"error")},onPlaybackQualityChange:function onPlaybackQualityChange(event){var instance=event.target;player.media.quality=instance.getPlaybackQuality();utils.dispatchEvent.call(player,player.media,"qualitychange")},onPlaybackRateChange:function onPlaybackRateChange(event){var instance=event.target;player.media.playbackRate=instance.getPlaybackRate();utils.dispatchEvent.call(player,player.media,"ratechange")},onReady:function onReady(event){var instance=event.target;youtube.getTitle.call(player,videoId);player.media.play=function(){instance.playVideo()};player.media.pause=function(){instance.pauseVideo()};player.media.stop=function(){instance.stopVideo()};player.media.duration=instance.getDuration();player.media.paused=true;player.media.currentTime=0;Object.defineProperty(player.media,"currentTime",{get:function get(){return Number(instance.getCurrentTime())},set:function set(time){player.media.seeking=true;utils.dispatchEvent.call(player,player.media,"seeking");instance.seekTo(time)}});Object.defineProperty(player.media,"playbackRate",{get:function get(){return instance.getPlaybackRate()},set:function set(input){instance.setPlaybackRate(input)}});Object.defineProperty(player.media,"quality",{get:function get(){return instance.getPlaybackQuality()},set:function set(input){utils.dispatchEvent.call(player,player.media,"qualityrequested",false,{quality:input});instance.setPlaybackQuality(input)}});var volume=player.config.volume;Object.defineProperty(player.media,"volume",{get:function get(){return volume},set:function set(input){volume=input;instance.setVolume(volume*100);utils.dispatchEvent.call(player,player.media,"volumechange")}});var muted=player.config.muted;Object.defineProperty(player.media,"muted",{get:function get(){return muted},set:function set(input){var toggle=utils.is.boolean(input)?input:muted;muted=toggle;instance[toggle?"mute":"unMute"]();utils.dispatchEvent.call(player,player.media,"volumechange")}});Object.defineProperty(player.media,"currentSrc",{get:function get(){return instance.getVideoUrl()}});Object.defineProperty(player.media,"ended",{get:function get(){return player.currentTime===player.duration}});player.options.speed=instance.getAvailablePlaybackRates();if(player.supported.ui){player.media.setAttribute("tabindex",-1)}utils.dispatchEvent.call(player,player.media,"timeupdate");utils.dispatchEvent.call(player,player.media,"durationchange");clearInterval(player.timers.buffering);player.timers.buffering=setInterval(function(){player.media.buffered=instance.getVideoLoadedFraction();if(player.media.lastBuffered===null||player.media.lastBuffered<player.media.buffered){utils.dispatchEvent.call(player,player.media,"progress")}player.media.lastBuffered=player.media.buffered;if(player.media.buffered===1){clearInterval(player.timers.buffering);utils.dispatchEvent.call(player,player.media,"canplaythrough")}},200);setTimeout(function(){return ui.build.call(player)},50)},onStateChange:function onStateChange(event){var instance=event.target;clearInterval(player.timers.playing);console.warn(event.data);switch(event.data){case-1:utils.dispatchEvent.call(player,player.media,"timeupdate");player.media.buffered=instance.getVideoLoadedFraction();utils.dispatchEvent.call(player,player.media,"progress");break;case 0:player.media.paused=true;if(player.media.loop){instance.stopVideo();instance.playVideo()}else{utils.dispatchEvent.call(player,player.media,"ended")}break;case 1:if(player.media.seeking){utils.dispatchEvent.call(player,player.media,"seeked")}player.media.seeking=false;if(player.media.paused){utils.dispatchEvent.call(player,player.media,"play")}player.media.paused=false;utils.dispatchEvent.call(player,player.media,"playing");player.timers.playing=setInterval(function(){utils.dispatchEvent.call(player,player.media,"timeupdate")},50);if(player.media.duration!==instance.getDuration()){player.media.duration=instance.getDuration();utils.dispatchEvent.call(player,player.media,"durationchange")}controls.setQualityMenu.call(player,instance.getAvailableQualityLevels());break;case 2:player.media.paused=true;utils.dispatchEvent.call(player,player.media,"pause");break;default:break}utils.dispatchEvent.call(player,player.elements.container,"statechange",false,{code:event.data})}}})}};var vimeo={setup:function setup(){var _this=this;utils.toggleClass(this.elements.wrapper,this.config.classNames.embed,true);vimeo.setAspectRatio.call(this);if(!utils.is.object(window.Vimeo)){utils.loadScript(this.config.urls.vimeo.api).then(function(){vimeo.ready.call(_this)}).catch(function(error){_this.debug.warn("Vimeo API failed to load",error)})}else{vimeo.ready.call(this)}},setAspectRatio:function setAspectRatio(input){var ratio=utils.is.string(input)?input.split(":"):this.config.ratio.split(":");var padding=100/ratio[0]*ratio[1];var height=240;var offset=(height-padding)/(height/50);this.elements.wrapper.style.paddingBottom=padding+"%";this.media.style.transform="translateY(-"+offset+"%)"},ready:function ready(){var _this2=this;var player=this;var options={loop:player.config.loop.active,autoplay:player.autoplay,byline:false,portrait:false,title:false,speed:true,transparent:0,gesture:"media"};var params=utils.buildUrlParams(options);var source=player.media.getAttribute("src");if(utils.is.empty(source)){source=player.media.getAttribute(this.config.attributes.embed.id)}var id=utils.parseVimeoId(source);var iframe=utils.createElement("iframe");var src="https://player.vimeo.com/video/"+id+"?"+params;iframe.setAttribute("src",src);iframe.setAttribute("allowfullscreen","");iframe.setAttribute("allowtransparency","");iframe.setAttribute("allow","autoplay");var wrapper=utils.createElement("div");wrapper.appendChild(iframe);player.media=utils.replaceElement(wrapper,player.media);player.embed=new window.Vimeo.Player(iframe);player.media.paused=true;player.media.currentTime=0;player.media.play=function(){player.embed.play().then(function(){player.media.paused=false})};player.media.pause=function(){player.embed.pause().then(function(){player.media.paused=true})};player.media.stop=function(){player.pause();player.currentTime=0};var currentTime=player.media.currentTime;Object.defineProperty(player.media,"currentTime",{get:function get(){return currentTime},set:function set(time){var paused=player.media.paused;player.media.seeking=true;utils.dispatchEvent.call(player,player.media,"seeking");player.embed.setCurrentTime(time);if(paused){player.pause()}}});var speed=player.config.speed.selected;Object.defineProperty(player.media,"playbackRate",{get:function get(){return speed},set:function set(input){player.embed.setPlaybackRate(input).then(function(){speed=input;utils.dispatchEvent.call(player,player.media,"ratechange")})}});var volume=player.config.volume;Object.defineProperty(player.media,"volume",{get:function get(){return volume},set:function set(input){player.embed.setVolume(input).then(function(){volume=input;utils.dispatchEvent.call(player,player.media,"volumechange")})}});var muted=player.config.muted;Object.defineProperty(player.media,"muted",{get:function get(){return muted},set:function set(input){var toggle=utils.is.boolean(input)?input:false;player.embed.setVolume(toggle?0:player.config.volume).then(function(){muted=toggle;utils.dispatchEvent.call(player,player.media,"volumechange")})}});var loop=player.config.loop;Object.defineProperty(player.media,"loop",{get:function get(){return loop},set:function set(input){var toggle=utils.is.boolean(input)?input:player.config.loop.active;player.embed.setLoop(toggle).then(function(){loop=toggle})}});var currentSrc=void 0;player.embed.getVideoUrl().then(function(value){currentSrc=value});Object.defineProperty(player.media,"currentSrc",{get:function get(){return currentSrc}});Object.defineProperty(player.media,"ended",{get:function get(){return player.currentTime===player.duration}});Promise.all([player.embed.getVideoWidth(),player.embed.getVideoHeight()]).then(function(dimensions){var ratio=utils.getAspectRatio(dimensions[0],dimensions[1]);vimeo.setAspectRatio.call(_this2,ratio)});player.embed.setAutopause(player.config.autopause).then(function(state){player.config.autopause=state});player.embed.getVideoTitle().then(function(title){player.config.title=title;ui.setTitle.call(_this2)});player.embed.getCurrentTime().then(function(value){currentTime=value;utils.dispatchEvent.call(player,player.media,"timeupdate")});player.embed.getDuration().then(function(value){player.media.duration=value;utils.dispatchEvent.call(player,player.media,"durationchange")});player.embed.getTextTracks().then(function(tracks){player.media.textTracks=tracks;captions.setup.call(player)});player.embed.on("cuechange",function(data){var cue=null;if(data.cues.length){cue=utils.stripHTML(data.cues[0].text)}captions.setText.call(player,cue)});player.embed.on("loaded",function(){if(utils.is.element(player.embed.element)&&player.supported.ui){var frame=player.embed.element;frame.setAttribute("tabindex",-1)}});player.embed.on("play",function(){if(player.media.paused){utils.dispatchEvent.call(player,player.media,"play")}player.media.paused=false;utils.dispatchEvent.call(player,player.media,"playing")});player.embed.on("pause",function(){player.media.paused=true;utils.dispatchEvent.call(player,player.media,"pause")});player.embed.on("timeupdate",function(data){player.media.seeking=false;currentTime=data.seconds;utils.dispatchEvent.call(player,player.media,"timeupdate")});player.embed.on("progress",function(data){player.media.buffered=data.percent;utils.dispatchEvent.call(player,player.media,"progress");if(parseInt(data.percent,10)===1){utils.dispatchEvent.call(player,player.media,"canplaythrough")}});player.embed.on("seeked",function(){player.media.seeking=false;utils.dispatchEvent.call(player,player.media,"seeked");utils.dispatchEvent.call(player,player.media,"play")});player.embed.on("ended",function(){player.media.paused=true;utils.dispatchEvent.call(player,player.media,"ended")});player.embed.on("error",function(detail){player.media.error=detail;utils.dispatchEvent.call(player,player.media,"error")});setTimeout(function(){return ui.build.call(player)},0)}};var browser$3=utils.getBrowser();var media={setup:function setup(){if(!this.media){this.debug.warn("No media element found!");return}utils.toggleClass(this.elements.container,this.config.classNames.type.replace("{0}",this.type),true);utils.toggleClass(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),true);if(this.isEmbed){utils.toggleClass(this.elements.container,this.config.classNames.type.replace("{0}","video"),true)}if(this.supported.ui){utils.toggleClass(this.elements.container,this.config.classNames.pip.supported,support.pip&&this.isHTML5&&this.isVideo);utils.toggleClass(this.elements.container,this.config.classNames.airplay.supported,support.airplay&&this.isHTML5);utils.toggleClass(this.elements.container,this.config.classNames.stopped,this.config.autoplay);utils.toggleClass(this.elements.container,this.config.classNames.isIos,browser$3.isIos);utils.toggleClass(this.elements.container,this.config.classNames.isTouch,support.touch)}if(this.isVideo){this.elements.wrapper=utils.createElement("div",{class:this.config.classNames.video});utils.wrap(this.media,this.elements.wrapper)}if(this.isEmbed){switch(this.provider){case"youtube":youtube.setup.call(this);break;case"vimeo":vimeo.setup.call(this);break;default:break}}else if(this.isHTML5){ui.setTitle.call(this)}},cancelRequests:function cancelRequests(){if(!this.isHTML5){return}utils.removeElement(this.media.querySelectorAll("source"));this.media.setAttribute("src",this.config.blankVideo);this.media.load();this.debug.log("Cancelled network requests")}};var source={insertElements:function insertElements(type,attributes){var _this=this;if(utils.is.string(attributes)){utils.insertElement(type,this.media,{src:attributes})}else if(utils.is.array(attributes)){attributes.forEach(function(attribute){utils.insertElement(type,_this.media,attribute)})}},change:function change(input){var _this2=this;if(!utils.is.object(input)||!("sources"in input)||!input.sources.length){this.debug.warn("Invalid source format");return}media.cancelRequests.call(this);this.destroy.call(this,function(){utils.removeElement(_this2.media);_this2.media=null;if(utils.is.element(_this2.elements.container)){_this2.elements.container.removeAttribute("class")}_this2.type=input.type;_this2.provider=!utils.is.empty(input.sources[0].provider)?input.sources[0].provider:providers.html5;_this2.supported=support.check(_this2.type,_this2.provider,_this2.config.inline);switch(_this2.provider+":"+_this2.type){case"html5:video":_this2.media=utils.createElement("video");break;case"html5:audio":_this2.media=utils.createElement("audio");break;case"youtube:video":case"vimeo:video":_this2.media=utils.createElement("div",{src:input.sources[0].src});break;default:break}_this2.elements.container.appendChild(_this2.media);if(utils.is.boolean(input.autoplay)){_this2.config.autoplay=input.autoplay}if(_this2.isHTML5){if(_this2.config.crossorigin){_this2.media.setAttribute("crossorigin","")}if(_this2.config.autoplay){_this2.media.setAttribute("autoplay","")}if("poster"in input){_this2.media.setAttribute("poster",input.poster)}if(_this2.config.loop.active){_this2.media.setAttribute("loop","")}if(_this2.config.muted){_this2.media.setAttribute("muted","")}if(_this2.config.inline){_this2.media.setAttribute("playsinline","")}}ui.addStyleHook.call(_this2);if(_this2.isHTML5){source.insertElements.call(_this2,"source",input.sources)}_this2.config.title=input.title;media.setup.call(_this2);if(_this2.isHTML5){if("tracks"in input){source.insertElements.call(_this2,"track",input.tracks)}_this2.media.load()}if(_this2.isHTML5||_this2.isEmbed&&!_this2.supported.ui){ui.build.call(_this2)}_this2.fullscreen.update()},true)}};var Plyr=function(){function Plyr(target,options){var _this=this;classCallCheck(this,Plyr);this.timers={};this.ready=false;this.loading=false;this.failed=false;this.media=target;if(utils.is.string(this.media)){this.media=document.querySelectorAll(this.media)}if(window.jQuery&&this.media instanceof jQuery||utils.is.nodeList(this.media)||utils.is.array(this.media)){this.media=this.media[0]}this.config=utils.extend({},defaults,options,function(){try{return JSON.parse(_this.media.getAttribute("data-plyr-config"))}catch(e){return{}}}());this.elements={container:null,buttons:{},display:{},progress:{},inputs:{},settings:{menu:null,panes:{},tabs:{}},captions:null};this.captions={active:null,currentTrack:null};this.fullscreen={active:false};this.options={speed:[],quality:[]};this.debug=new Console(this.config.debug);this.debug.log("Config",this.config);this.debug.log("Support",support);if(utils.is.nullOrUndefined(this.media)||!utils.is.element(this.media)){this.debug.error("Setup failed: no suitable element passed");return}if(this.media.plyr){this.debug.warn("Target already setup");return}if(!this.config.enabled){this.debug.error("Setup failed: disabled by config");return}if(!support.check().api){this.debug.error("Setup failed: no support");return}this.elements.original=this.media.cloneNode(true);var type=this.media.tagName.toLowerCase();var iframe=null;var url=null;var params=null;switch(type){case"div":iframe=this.media.querySelector("iframe");if(utils.is.element(iframe)){url=iframe.getAttribute("src");this.provider=utils.getProviderByUrl(url);this.elements.container=this.media;this.media=iframe;this.elements.container.className="";params=utils.getUrlParams(url);if(!utils.is.empty(params)){var truthy=["1","true"];if(truthy.includes(params.autoplay)){this.config.autoplay=true}if(truthy.includes(params.playsinline)){this.config.inline=true}if(truthy.includes(params.loop)){this.config.loop.active=true}}}else{this.provider=this.media.getAttribute(this.config.attributes.embed.provider);this.media.removeAttribute(this.config.attributes.embed.provider)}if(utils.is.empty(this.provider)||!Object.keys(providers).includes(this.provider)){this.debug.error("Setup failed: Invalid provider");return}this.type=types.video;break;case"video":case"audio":this.type=type;this.provider=providers.html5;if(this.media.hasAttribute("crossorigin")){this.config.crossorigin=true}if(this.media.hasAttribute("autoplay")){this.config.autoplay=true}if(this.media.hasAttribute("playsinline")){this.config.inline=true}if(this.media.hasAttribute("muted")){this.config.muted=true}if(this.media.hasAttribute("loop")){this.config.loop.active=true}break;default:this.debug.error("Setup failed: unsupported type");return}this.supported=support.check(this.type,this.provider,this.config.inline);if(!this.supported.api){this.debug.error("Setup failed: no support");return}this.listeners=new Listeners(this);this.storage=new Storage(this);this.media.plyr=this;if(!utils.is.element(this.elements.container)){this.elements.container=utils.createElement("div");utils.wrap(this.media,this.elements.container)}this.elements.container.setAttribute("tabindex",0);ui.addStyleHook.call(this);media.setup.call(this);if(this.config.debug){utils.on(this.elements.container,this.config.events.join(" "),function(event){_this.debug.log("event: "+event.type)})}if(this.isHTML5||this.isEmbed&&!this.supported.ui){ui.build.call(this)}this.listeners.container();this.listeners.global();this.fullscreen=new Fullscreen(this);this.ads=new Ads(this)}createClass(Plyr,[{key:"play",value:function play(){var _this2=this;if(!utils.is.function(this.media.play)){return null}if(this.ads.enabled&&!this.ads.initialized){return this.ads.managerPromise.then(function(){return _this2.ads.play()}).catch(function(){return _this2.media.play()})}return this.media.play()}},{key:"pause",value:function pause(){if(!this.playing||!utils.is.function(this.media.pause)){return}this.media.pause()}},{key:"togglePlay",value:function togglePlay(input){var toggle=utils.is.boolean(input)?input:!this.playing;if(toggle){this.play()}else{this.pause()}}},{key:"stop",value:function stop(){if(this.isHTML5){this.media.load()}else{this.media.stop()}}},{key:"restart",value:function restart(){this.currentTime=0}},{key:"rewind",value:function rewind(seekTime){this.currentTime=this.currentTime-(utils.is.number(seekTime)?seekTime:this.config.seekTime)}},{key:"forward",value:function forward(seekTime){this.currentTime=this.currentTime+(utils.is.number(seekTime)?seekTime:this.config.seekTime)}},{key:"increaseVolume",value:function increaseVolume(step){var volume=this.media.muted?0:this.volume;this.volume=volume+(utils.is.number(step)?step:1)}},{key:"decreaseVolume",value:function decreaseVolume(step){var volume=this.media.muted?0:this.volume;this.volume=volume-(utils.is.number(step)?step:1)}},{key:"toggleCaptions",value:function toggleCaptions(input){if(!this.supported.ui||!utils.is.element(this.elements.buttons.captions)){return}var show=utils.is.boolean(input)?input:this.elements.container.className.indexOf(this.config.classNames.captions.active)===-1;if(this.captions.active===show){return}this.captions.active=show;utils.toggleState(this.elements.buttons.captions,this.captions.active);utils.toggleClass(this.elements.container,this.config.classNames.captions.active,this.captions.active);utils.dispatchEvent.call(this,this.media,this.captions.active?"captionsenabled":"captionsdisabled")}},{key:"airplay",value:function airplay(){if(support.airplay){this.media.webkitShowPlaybackTargetPicker()}}},{key:"toggleControls",value:function toggleControls(toggle){var _this3=this;if(!utils.is.element(this.elements.controls)){return}if(!this.supported.ui||this.isAudio){return}var delay=0;var show=toggle;var isEnterFullscreen=false;if(!utils.is.boolean(toggle)){if(utils.is.event(toggle)){isEnterFullscreen=toggle.type==="enterfullscreen";show=["mouseenter","mousemove","touchstart","touchmove","focusin"].includes(toggle.type);if(["mousemove","touchmove","touchend"].includes(toggle.type)){delay=2e3}if(toggle.type==="focusin"){delay=3e3;utils.toggleClass(this.elements.controls,this.config.classNames.noTransition,true)}}else{show=utils.hasClass(this.elements.container,this.config.classNames.hideControls)}}clearTimeout(this.timers.controls);if(show||this.paused||this.loading){var toggled=utils.toggleClass(this.elements.container,this.config.classNames.hideControls,false);if(toggled){utils.dispatchEvent.call(this,this.media,"controlsshown")}if(this.paused||this.loading){return}if(support.touch){delay=3e3}}if(!show||this.playing){this.timers.controls=setTimeout(function(){if((_this3.elements.controls.pressed||_this3.elements.controls.hover)&&!isEnterFullscreen){return}if(!utils.hasClass(_this3.elements.container,_this3.config.classNames.hideControls)){utils.toggleClass(_this3.elements.controls,_this3.config.classNames.noTransition,false)}var toggled=utils.toggleClass(_this3.elements.container,_this3.config.classNames.hideControls,true);if(toggled){utils.dispatchEvent.call(_this3,_this3.media,"controlshidden");if(_this3.config.controls.includes("settings")&&!utils.is.empty(_this3.config.settings)){controls.toggleMenu.call(_this3,false)}}},delay)}}},{key:"on",value:function on(event,callback){utils.on(this.elements.container,event,callback)}},{key:"off",value:function off(event,callback){utils.off(this.elements.container,event,callback)}},{key:"destroy",value:function destroy(callback){var _this4=this;var soft=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.ready){return}var done=function done(){document.body.style.overflow="";_this4.embed=null;if(soft){if(Object.keys(_this4.elements).length){utils.removeElement(_this4.elements.buttons.play);utils.removeElement(_this4.elements.captions);utils.removeElement(_this4.elements.controls);utils.removeElement(_this4.elements.wrapper);_this4.elements.buttons.play=null;_this4.elements.captions=null;_this4.elements.controls=null;_this4.elements.wrapper=null}if(utils.is.function(callback)){callback()}}else{_this4.listeners.clear();utils.replaceElement(_this4.elements.original,_this4.elements.container);utils.dispatchEvent.call(_this4,_this4.elements.original,"destroyed",true);if(utils.is.function(callback)){callback.call(_this4.elements.original)}_this4.ready=false;setTimeout(function(){_this4.elements=null;_this4.media=null},200)}};this.stop();switch(this.provider+":"+this.type){case"html5:video":case"html5:audio":clearTimeout(this.timers.loading);ui.toggleNativeControls.call(this,true);done();break;case"youtube:video":clearInterval(this.timers.buffering);clearInterval(this.timers.playing);if(this.embed!==null&&utils.is.function(this.embed.destroy)){this.embed.destroy()}done();break;case"vimeo:video":if(this.embed!==null){this.embed.unload().then(done)}setTimeout(done,200);break;default:break}}},{key:"supports",value:function supports(type){return support.mime.call(this,type)}},{key:"isHTML5",get:function get$$1(){return Boolean(this.provider===providers.html5)}},{key:"isEmbed",get:function get$$1(){return Boolean(this.isYouTube||this.isVimeo)}},{key:"isYouTube",get:function get$$1(){return Boolean(this.provider===providers.youtube)}},{key:"isVimeo",get:function get$$1(){return Boolean(this.provider===providers.vimeo)}},{key:"isVideo",get:function get$$1(){return Boolean(this.type===types.video)}},{key:"isAudio",get:function get$$1(){return Boolean(this.type===types.audio)}},{key:"paused",get:function get$$1(){return Boolean(this.media.paused)}},{key:"playing",get:function get$$1(){return Boolean(!this.paused&&!this.ended&&(this.isHTML5?this.media.readyState>2:true))}},{key:"ended",get:function get$$1(){return Boolean(this.media.ended)}},{key:"currentTime",set:function set$$1(input){var targetTime=0;if(utils.is.number(input)){targetTime=input}if(targetTime<0){targetTime=0}else if(targetTime>this.duration){targetTime=this.duration}this.media.currentTime=parseFloat(targetTime.toFixed(4));this.debug.log("Seeking to "+this.currentTime+" seconds")},get:function get$$1(){return Number(this.media.currentTime)}},{key:"buffered",get:function get$$1(){var buffered=this.media.buffered;if(utils.is.number(buffered)){return buffered}if(buffered&&buffered.length&&this.duration>0){return buffered.end(0)/this.duration}return 0}},{key:"seeking",get:function get$$1(){return Boolean(this.media.seeking)}},{key:"duration",get:function get$$1(){var fauxDuration=parseInt(this.config.duration,10);var realDuration=this.media?Number(this.media.duration):0;return!Number.isNaN(fauxDuration)?fauxDuration:realDuration}},{key:"volume",set:function set$$1(value){var volume=value;var max=1;var min=0;if(utils.is.string(volume)){volume=Number(volume)}if(!utils.is.number(volume)){volume=this.storage.get("volume")}if(!utils.is.number(volume)){volume=this.config.volume}if(volume>max){volume=max}if(volume<min){volume=min}this.config.volume=volume;this.media.volume=volume;if(this.muted&&volume>0){this.muted=false}},get:function get$$1(){return Number(this.media.volume)}},{key:"muted",set:function set$$1(mute){var toggle=mute;if(!utils.is.boolean(toggle)){toggle=this.storage.get("muted")}if(!utils.is.boolean(toggle)){toggle=this.config.muted}this.config.muted=toggle;this.media.muted=toggle},get:function get$$1(){return Boolean(this.media.muted)}},{key:"hasAudio",get:function get$$1(){if(!this.isHTML5){return true}if(this.isAudio){return true}return Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}},{key:"speed",set:function set$$1(input){var speed=null;if(utils.is.number(input)){speed=input}if(!utils.is.number(speed)){speed=this.storage.get("speed")}if(!utils.is.number(speed)){speed=this.config.speed.selected}if(speed<.1){speed=.1}if(speed>2){speed=2}if(!this.config.speed.options.includes(speed)){this.debug.warn("Unsupported speed ("+speed+")");return}this.config.speed.selected=speed;this.media.playbackRate=speed},get:function get$$1(){return Number(this.media.playbackRate)}},{key:"quality",set:function set$$1(input){var quality=null;if(utils.is.string(input)){quality=input}if(!utils.is.string(quality)){quality=this.storage.get("quality")}if(!utils.is.string(quality)){quality=this.config.quality.selected}if(!this.options.quality.includes(quality)){this.debug.warn("Unsupported quality option ("+quality+")");return}this.config.quality.selected=quality;this.media.quality=quality},get:function get$$1(){return this.media.quality}},{key:"loop",set:function set$$1(input){var toggle=utils.is.boolean(input)?input:this.config.loop.active;this.config.loop.active=toggle;this.media.loop=toggle},get:function get$$1(){return Boolean(this.media.loop)}},{key:"source",set:function set$$1(input){source.change.call(this,input)},get:function get$$1(){return this.media.currentSrc}},{key:"poster",set:function set$$1(input){if(!this.isHTML5||!this.isVideo){this.debug.warn("Poster can only be set on HTML5 video");return}if(utils.is.string(input)){this.media.setAttribute("poster",input)}},get:function get$$1(){if(!this.isHTML5||!this.isVideo){return null}return this.media.getAttribute("poster")}},{key:"autoplay",set:function set$$1(input){var toggle=utils.is.boolean(input)?input:this.config.autoplay;this.config.autoplay=toggle},get:function get$$1(){return Boolean(this.config.autoplay)}},{key:"language",set:function set$$1(input){if(!utils.is.string(input)){return}this.toggleCaptions(!utils.is.empty(input));if(utils.is.empty(input)){return}var language=input.toLowerCase();if(this.language===language){return}this.captions.language=language;captions.setText.call(this,null);captions.setLanguage.call(this);utils.dispatchEvent.call(this,this.media,"languagechange")},get:function get$$1(){return this.captions.language}},{key:"pip",set:function set$$1(input){var states={pip:"picture-in-picture",inline:"inline"};if(!support.pip){return}var toggle=utils.is.boolean(input)?input:this.pip===states.inline;this.media.webkitSetPresentationMode(toggle?states.pip:states.inline)},get:function get$$1(){if(!support.pip){return null}return this.media.webkitPresentationMode}}],[{key:"supported",value:function supported(type,provider,inline){return support.check(type,provider,inline)}},{key:"loadSprite",value:function loadSprite(url,id){return utils.loadSprite(url,id)}}]);return Plyr}();return Plyr});